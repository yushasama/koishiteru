<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Scribble Export</title>
  <style>.Õº1.cm-focused {outline: 1px dotted #212121;}
.Õº1 {position: relative !important; box-sizing: border-box; display: flex !important; flex-direction: column;}
.Õº1 .cm-scroller {display: flex !important; align-items: flex-start !important; font-family: monospace; line-height: 1.4; height: 100%; overflow-x: auto; position: relative; z-index: 0; overflow-anchor: none;}
.Õº1 .cm-content[contenteditable=true] {-webkit-user-modify: read-write-plaintext-only;}
.Õº1 .cm-content {margin: 0; flex-grow: 2; flex-shrink: 0; display: block; white-space: pre; word-wrap: normal; box-sizing: border-box; min-height: 100%; padding: 4px 0; outline: none;}
.Õº1 .cm-lineWrapping {white-space: pre-wrap; white-space: break-spaces; word-break: break-word; overflow-wrap: anywhere; flex-shrink: 1;}
.Õº2 .cm-content {caret-color: black;}
.Õº3 .cm-content {caret-color: white;}
.Õº1 .cm-line {display: block; padding: 0 2px 0 6px;}
.Õº1 .cm-layer > * {position: absolute;}
.Õº1 .cm-layer {position: absolute; left: 0; top: 0; contain: size style;}
.Õº2 .cm-selectionBackground {background: #d9d9d9;}
.Õº3 .cm-selectionBackground {background: #222;}
.Õº2.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground {background: #d7d4f0;}
.Õº3.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground {background: #233;}
.Õº1 .cm-cursorLayer {pointer-events: none;}
.Õº1.cm-focused > .cm-scroller > .cm-cursorLayer {animation: steps(1) cm-blink 1.2s infinite;}
@keyframes cm-blink {50% {opacity: 0;}}
@keyframes cm-blink2 {50% {opacity: 0;}}
.Õº1 .cm-cursor, .Õº1 .cm-dropCursor {border-left: 1.2px solid black; margin-left: -0.6px; pointer-events: none;}
.Õº1 .cm-cursor {display: none;}
.Õº3 .cm-cursor {border-left-color: #ddd;}
.Õº1 .cm-dropCursor {position: absolute;}
.Õº1.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor {display: block;}
.Õº1 .cm-iso {unicode-bidi: isolate;}
.Õº1 .cm-announced {position: fixed; top: -10000px;}
@media print {.Õº1 .cm-announced {display: none;}}
.Õº2 .cm-activeLine {background-color: #cceeff44;}
.Õº3 .cm-activeLine {background-color: #99eeff33;}
.Õº2 .cm-specialChar {color: red;}
.Õº3 .cm-specialChar {color: #f78;}
.Õº1 .cm-gutters {flex-shrink: 0; display: flex; height: 100%; box-sizing: border-box; z-index: 200;}
.Õº1 .cm-gutters-before {inset-inline-start: 0;}
.Õº1 .cm-gutters-after {inset-inline-end: 0;}
.Õº2 .cm-gutters.cm-gutters-before {border-right-width: 1px;}
.Õº2 .cm-gutters.cm-gutters-after {border-left-width: 1px;}
.Õº2 .cm-gutters {background-color: #f5f5f5; color: #6c6c6c; border: 0px solid #ddd;}
.Õº3 .cm-gutters {background-color: #333338; color: #ccc;}
.Õº1 .cm-gutter {display: flex !important; flex-direction: column; flex-shrink: 0; box-sizing: border-box; min-height: 100%; overflow: hidden;}
.Õº1 .cm-gutterElement {box-sizing: border-box;}
.Õº1 .cm-lineNumbers .cm-gutterElement {padding: 0 3px 0 5px; min-width: 20px; text-align: right; white-space: nowrap;}
.Õº2 .cm-activeLineGutter {background-color: #e2f2ff;}
.Õº3 .cm-activeLineGutter {background-color: #222227;}
.Õº1 .cm-panels {box-sizing: border-box; position: sticky; left: 0; right: 0; z-index: 300;}
.Õº2 .cm-panels {background-color: #f5f5f5; color: black;}
.Õº2 .cm-panels-top {border-bottom: 1px solid #ddd;}
.Õº2 .cm-panels-bottom {border-top: 1px solid #ddd;}
.Õº3 .cm-panels {background-color: #333338; color: white;}
.Õº1 .cm-dialog label {font-size: 80%;}
.Õº1 .cm-dialog {padding: 2px 19px 4px 6px; position: relative;}
.Õº1 .cm-dialog-close {position: absolute; top: 3px; right: 4px; background-color: inherit; border: none; font: inherit; font-size: 14px; padding: 0;}
.Õº1 .cm-tab {display: inline-block; overflow: hidden; vertical-align: bottom;}
.Õº1 .cm-widgetBuffer {vertical-align: text-top; height: 1em; width: 0; display: inline;}
.Õº1 .cm-placeholder {color: #888; display: inline-block; vertical-align: top; user-select: none;}
.Õº1 .cm-highlightSpace {background-image: radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%); background-position: center;}
.Õº1 .cm-highlightTab {background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>'); background-size: auto 100%; background-position: right 90%; background-repeat: no-repeat;}
.Õº1 .cm-trailingSpace {background-color: #ff332255;}
.Õº1 .cm-button {vertical-align: middle; color: inherit; font-size: 70%; padding: .2em 1em; border-radius: 1px;}
.Õº2 .cm-button:active {background-image: linear-gradient(#b4b4b4, #d0d3d6);}
.Õº2 .cm-button {background-image: linear-gradient(#eff1f5, #d9d9df); border: 1px solid #888;}
.Õº3 .cm-button:active {background-image: linear-gradient(#111, #333);}
.Õº3 .cm-button {background-image: linear-gradient(#393939, #111); border: 1px solid #888;}
.Õº1 .cm-textfield {vertical-align: middle; color: inherit; font-size: 70%; border: 1px solid silver; padding: .2em .5em;}
.Õº2 .cm-textfield {background-color: white;}
.Õº3 .cm-textfield {border: 1px solid #555; background-color: inherit;}
.Õº1 .cm-panel.cm-search [name=close] {position: absolute; top: 0; right: 4px; background-color: inherit; border: none; font: inherit; padding: 0; margin: 0;}
.Õº1 .cm-panel.cm-search input, .Õº1 .cm-panel.cm-search button, .Õº1 .cm-panel.cm-search label {margin: .2em .6em .2em 0;}
.Õº1 .cm-panel.cm-search input[type=checkbox] {margin-right: .2em;}
.Õº1 .cm-panel.cm-search label {font-size: 80%; white-space: pre;}
.Õº1 .cm-panel.cm-search {padding: 2px 6px 4px; position: relative;}
.Õº2 .cm-searchMatch {background-color: #ffff0054;}
.Õº3 .cm-searchMatch {background-color: #00ffff8a;}
.Õº2 .cm-searchMatch-selected {background-color: #ff6a0054;}
.Õº3 .cm-searchMatch-selected {background-color: #ff00ff8a;}
.Õº1 .cm-selectionMatch {background-color: #99ff7780;}
.Õº1 .cm-searchMatch .cm-selectionMatch {background-color: transparent;}
.Õº1 .cm-tooltip.cm-tooltip-autocomplete > ul > li, .Õº1 .cm-tooltip.cm-tooltip-autocomplete > ul > completion-section {padding: 1px 3px; line-height: 1.2;}
.Õº1 .cm-tooltip.cm-tooltip-autocomplete > ul > li {overflow-x: hidden; text-overflow: ellipsis; cursor: pointer;}
.Õº1 .cm-tooltip.cm-tooltip-autocomplete > ul > completion-section {display: list-item; border-bottom: 1px solid silver; padding-left: 0.5em; opacity: 0.7;}
.Õº1 .cm-tooltip.cm-tooltip-autocomplete > ul {font-family: monospace; white-space: nowrap; overflow: hidden auto; max-width: 700px; max-width: min(700px, 95vw); min-width: 250px; max-height: 10em; height: 100%; list-style: none; margin: 0; padding: 0;}
.Õº2 .cm-tooltip-autocomplete ul li[aria-selected] {background: #17c; color: white;}
.Õº2 .cm-tooltip-autocomplete-disabled ul li[aria-selected] {background: #777;}
.Õº3 .cm-tooltip-autocomplete ul li[aria-selected] {background: #347; color: white;}
.Õº3 .cm-tooltip-autocomplete-disabled ul li[aria-selected] {background: #444;}
.Õº1 .cm-completionListIncompleteTop:before, .Õº1 .cm-completionListIncompleteBottom:after {content: "¬∑¬∑¬∑"; opacity: 0.5; display: block; text-align: center;}
.Õº1 .cm-tooltip.cm-completionInfo {position: absolute; padding: 3px 9px; width: max-content; max-width: 400px; box-sizing: border-box; white-space: pre-line;}
.Õº1 .cm-completionInfo.cm-completionInfo-left {right: 100%;}
.Õº1 .cm-completionInfo.cm-completionInfo-right {left: 100%;}
.Õº1 .cm-completionInfo.cm-completionInfo-left-narrow {right: 30px;}
.Õº1 .cm-completionInfo.cm-completionInfo-right-narrow {left: 30px;}
.Õº2 .cm-snippetField {background-color: #00000022;}
.Õº3 .cm-snippetField {background-color: #ffffff22;}
.Õº1 .cm-snippetFieldPosition {vertical-align: text-top; width: 0; height: 1.15em; display: inline-block; margin: 0 -0.7px -.7em; border-left: 1.4px dotted #888;}
.Õº1 .cm-completionMatchedText {text-decoration: underline;}
.Õº1 .cm-completionDetail {margin-left: 0.5em; font-style: italic;}
.Õº1 .cm-completionIcon {font-size: 90%; width: .8em; display: inline-block; text-align: center; padding-right: .6em; opacity: 0.6; box-sizing: content-box;}
.Õº1 .cm-completionIcon-function:after, .Õº1 .cm-completionIcon-method:after {content: '∆í';}
.Õº1 .cm-completionIcon-class:after {content: '‚óã';}
.Õº1 .cm-completionIcon-interface:after {content: '‚óå';}
.Õº1 .cm-completionIcon-variable:after {content: 'ùë•';}
.Õº1 .cm-completionIcon-constant:after {content: 'ùê∂';}
.Õº1 .cm-completionIcon-type:after {content: 'ùë°';}
.Õº1 .cm-completionIcon-enum:after {content: '‚à™';}
.Õº1 .cm-completionIcon-property:after {content: '‚ñ°';}
.Õº1 .cm-completionIcon-keyword:after {content: 'üîëÔ∏é';}
.Õº1 .cm-completionIcon-namespace:after {content: '‚ñ¢';}
.Õº1 .cm-completionIcon-text:after {content: 'abc'; font-size: 50%; vertical-align: middle;}
.Õº1 .cm-tooltip {z-index: 500; box-sizing: border-box;}
.Õº2 .cm-tooltip {border: 1px solid #bbb; background-color: #f5f5f5;}
.Õº2 .cm-tooltip-section:not(:first-child) {border-top: 1px solid #bbb;}
.Õº3 .cm-tooltip {background-color: #333338; color: white;}
.Õº1 .cm-tooltip-arrow:before, .Õº1 .cm-tooltip-arrow:after {content: ''; position: absolute; width: 0; height: 0; border-left: 7px solid transparent; border-right: 7px solid transparent;}
.Õº1 .cm-tooltip-above .cm-tooltip-arrow:before {border-top: 7px solid #bbb;}
.Õº1 .cm-tooltip-above .cm-tooltip-arrow:after {border-top: 7px solid #f5f5f5; bottom: 1px;}
.Õº1 .cm-tooltip-above .cm-tooltip-arrow {bottom: -7px;}
.Õº1 .cm-tooltip-below .cm-tooltip-arrow:before {border-bottom: 7px solid #bbb;}
.Õº1 .cm-tooltip-below .cm-tooltip-arrow:after {border-bottom: 7px solid #f5f5f5; top: 1px;}
.Õº1 .cm-tooltip-below .cm-tooltip-arrow {top: -7px;}
.Õº1 .cm-tooltip-arrow {height: 7px; width: 14px; position: absolute; z-index: -1; overflow: hidden;}
.Õº3 .cm-tooltip .cm-tooltip-arrow:before {border-top-color: #333338; border-bottom-color: #333338;}
.Õº3 .cm-tooltip .cm-tooltip-arrow:after {border-top-color: transparent; border-bottom-color: transparent;}
.Õº1.cm-focused .cm-matchingBracket {background-color: #328c8252;}
.Õº1.cm-focused .cm-nonmatchingBracket {background-color: #bb555544;}
.Õº1 .cm-foldPlaceholder {background-color: #eee; border: 1px solid #ddd; color: #888; border-radius: .2em; margin: 0 1px; padding: 0 1px; cursor: pointer;}
.Õº1 .cm-foldGutter span {padding: 0 1px; cursor: pointer;}
.Õºr {background: #ffffff; color: #333333;}
.Õºr .cm-content {background-color: #ffffff; color: #333333;}
.Õºr .cm-focused {outline: none;}
.Õºr .cm-editor {background-color: #ffffff;}
.Õºr .cm-scroller {background-color: #ffffff;}
.Õºr .cm-gutters {background-color: #f5f5f5; border-right: 1px solid #e1e1e1;}
.Õºr .cm-lineNumbers {color: #333333; opacity: 0.6;}
.Õºr .cm-cursor {border-left: 2px solid #ff6b6b;}
.Õºr .cm-activeLine {background: #f5f5f5;}
.Õºr .cm-selectionBackground {background: #ff0000;}
.Õºr.cm-focused .cm-selectionBackground {background: #cc0000;}
.Õºr .cm-selectionMatch {background: #ff0000; border-radius: 2px;}
.Õºr .cm-matchingBracket {background: #ff0000; outline: 1px solid #ff6b6b;}
.Õºr .cm-nonmatchingBracket {background-color: rgba(215, 58, 73, 0.3); outline: 1px solid #d73a49;}
.Õºr .cm-panels {background-color: transparent; border: none;}
.Õºr .cm-panels-top {border-bottom: 1px solid #e1e1e1; background-color: #f5f5f5;}
.Õºr .cm-panel.cm-search {background-color: #ffffff; border-radius: 8px; padding: 12px 16px; margin: 8px 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e1e1e1; display: flex; flex-wrap: wrap; align-items: center; gap: 10px; font-size: 13px;}
.Õºr .cm-panel.cm-search input {background-color: #ffffff; border: 1px solid #e1e1e1; border-radius: 6px; padding: 8px 12px; color: #333333; font-family: JetBrains Mono, monospace; font-size: 13px; width: 220px; transition: all 0.2s ease; box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);}
.Õºr .cm-panel.cm-search input:focus {border: 2px solid #007acc; outline: none; box-shadow: 0 0 0 3px rgba(0, 122, 204, 0.1), inset 0 1px 2px rgba(0,0,0,0.05); background-color: #ffffff;}
.Õºr .cm-panel.cm-search button {background-color: #007acc; border: 1px solid #007acc; border-radius: 6px; color: #ffffff; padding: 8px 16px; font-size: 12px; cursor: pointer; font-weight: 600; transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0, 122, 204, 0.3); text-transform: uppercase; letter-spacing: 0.5px;}
.Õºr .cm-panel.cm-search button:hover {background-color: #005a99; border-color: #005a99; opacity: 1; transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0, 122, 204, 0.3);}
.Õºr .cm-panel.cm-search button:active {background-color: #004080; border-color: #004080; transform: translateY(0); box-shadow: 0 2px 4px rgba(0, 122, 204, 0.3); opacity: 1;}
.Õºr .cm-panel.cm-search button:focus-visible {outline: 2px solid #007acc; outline-offset: 1px;}
.Õºr .cm-panel.cm-search button[name="replace"], .Õºr .cm-panel.cm-search button[name="replaceAll"] {background-color: #28a745; border-color: #28a745;}
.Õºr .cm-panel.cm-search button[name="replace"]:hover, .Õºr .cm-panel.cm-search button[name="replaceAll"]:hover {background-color: #22863a; border-color: #22863a;}
.Õºr .cm-panel.cm-search button[name="close"] {background: none; border: none; color: #333333; opacity: 0.6; font-size: 18px; padding: 4px 8px; box-shadow: none; border-radius: 4px; transition: all 0.2s ease;}
.Õºr .cm-panel.cm-search button[name="close"]:hover {background-color: #f5f5f5; color: #333333; opacity: 1; transform: scale(1.1); box-shadow: 0 2px 4px rgba(0,0,0,0.1);}
.Õºr .cm-panel.cm-search label {color: #333333; font-size: 12px; display: inline-flex; align-items: center; gap: 4px; cursor: pointer; user-select: none; white-space: nowrap; font-weight: 500;}
.Õºr .cm-panel.cm-search input[type="checkbox"] {width: 13px; height: 13px; cursor: pointer; accent-color: #ff6b6b;}
.Õºr .cm-searchMatch {background-color: rgba(0, 122, 204, 0.4); outline: 2px solid #007acc; border-radius: 2px; box-shadow: 0 0 0 1px rgba(0, 122, 204, 0.3);}
.Õºr .cm-searchMatch-selected {background-color: #007acc; color: #ffffff; outline: 2px solid #005a99; box-shadow: 0 0 4px rgba(0, 122, 204, 0.5);}
.Õºr .cm-panel button, .Õºr .cm-search button, .Õºr .cm-panel.cm-search button, .Õºr button[name="next"], .Õºr button[name="prev"], .Õºr button[name="select"], .Õºr button[name="replace"], .Õºr button[name="replaceAll"] {background-color: #007acc !important; border: 1px solid #007acc !important; color: #ffffff !important; border-radius: 6px !important; padding: 8px 16px !important; font-size: 12px !important; font-weight: 600 !important; text-transform: uppercase !important; letter-spacing: 0.5px !important;}
.Õºr .cm-panel button:hover, .Õºr .cm-search button:hover, .Õºr .cm-panel.cm-search button:hover, .Õºr button[name="next"]:hover, .Õºr button[name="prev"]:hover, .Õºr button[name="select"]:hover, .Õºr button[name="replace"]:hover, .Õºr button[name="replaceAll"]:hover {background-color: #005a99 !important; border-color: #005a99 !important;}
.Õºr button[class*="cm-"], .Õºr button[class*="search"], .Õºr .cm-editor button, .Õºr .CodeMirror button {background-color: #007acc !important; border: 1px solid #007acc !important; color: #ffffff !important;}
.Õºq {font-size: 14px; height: 100%;}
.Õºq .cm-content {padding: 16px; font-family: JetBrains Mono, Monaco, Consolas, monospace; line-height: 1.6; white-space: pre-wrap; word-break: break-word; overflow-wrap: break-word; hyphens: auto; max-width: 100%; overflow: hidden;}
.Õºq .cm-focused {outline: none;}
.Õºq .cm-editor {height: 100%;}
.Õºq .cm-scroller {font-family: JetBrains Mono, Monaco, Consolas, monospace; overflow: auto; white-space: pre-wrap; word-break: break-word; overflow-wrap: break-word; hyphens: auto; max-width: 100%;}
.Õºq .cm-selectionBackground {background: #ff0000 !important;}
.Õºq.cm-focused .cm-selectionBackground {background: #cc0000 !important;}
.Õºq .cm-selectionMatch {background: #ff0000 !important; border-radius: 2px;}
.Õºp {background: #ffffff; color: #333333;}
.Õºp .cm-content {background-color: #ffffff; color: #333333;}
.Õºp .cm-focused {outline: none;}
.Õºp .cm-editor {background-color: #ffffff;}
.Õºp .cm-scroller {background-color: #ffffff;}
.Õºp .cm-gutters {background-color: #f5f5f5; border-right: 1px solid #e1e1e1;}
.Õºp .cm-lineNumbers {color: #333333; opacity: 0.6;}
.Õºp .cm-cursor {border-left: 2px solid #ff6b6b;}
.Õºp .cm-activeLine {background: #f5f5f5;}
.Õºp .cm-selectionBackground {background: #ff0000;}
.Õºp.cm-focused .cm-selectionBackground {background: #cc0000;}
.Õºp .cm-selectionMatch {background: #ff0000; border-radius: 2px;}
.Õºp .cm-matchingBracket {background: #ff0000; outline: 1px solid #ff6b6b;}
.Õºp .cm-nonmatchingBracket {background-color: rgba(215, 58, 73, 0.3); outline: 1px solid #d73a49;}
.Õºp .cm-panels {background-color: transparent; border: none;}
.Õºp .cm-panels-top {border-bottom: 1px solid #e1e1e1; background-color: #f5f5f5;}
.Õºp .cm-panel.cm-search {background-color: #ffffff; border-radius: 8px; padding: 12px 16px; margin: 8px 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e1e1e1; display: flex; flex-wrap: wrap; align-items: center; gap: 10px; font-size: 13px;}
.Õºp .cm-panel.cm-search input {background-color: #ffffff; border: 1px solid #e1e1e1; border-radius: 6px; padding: 8px 12px; color: #333333; font-family: JetBrains Mono, monospace; font-size: 13px; width: 220px; transition: all 0.2s ease; box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);}
.Õºp .cm-panel.cm-search input:focus {border: 2px solid #007acc; outline: none; box-shadow: 0 0 0 3px rgba(0, 122, 204, 0.1), inset 0 1px 2px rgba(0,0,0,0.05); background-color: #ffffff;}
.Õºp .cm-panel.cm-search button {background-color: #007acc; border: 1px solid #007acc; border-radius: 6px; color: #ffffff; padding: 8px 16px; font-size: 12px; cursor: pointer; font-weight: 600; transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0, 122, 204, 0.3); text-transform: uppercase; letter-spacing: 0.5px;}
.Õºp .cm-panel.cm-search button:hover {background-color: #005a99; border-color: #005a99; opacity: 1; transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0, 122, 204, 0.3);}
.Õºp .cm-panel.cm-search button:active {background-color: #004080; border-color: #004080; transform: translateY(0); box-shadow: 0 2px 4px rgba(0, 122, 204, 0.3); opacity: 1;}
.Õºp .cm-panel.cm-search button:focus-visible {outline: 2px solid #007acc; outline-offset: 1px;}
.Õºp .cm-panel.cm-search button[name="replace"], .Õºp .cm-panel.cm-search button[name="replaceAll"] {background-color: #28a745; border-color: #28a745;}
.Õºp .cm-panel.cm-search button[name="replace"]:hover, .Õºp .cm-panel.cm-search button[name="replaceAll"]:hover {background-color: #22863a; border-color: #22863a;}
.Õºp .cm-panel.cm-search button[name="close"] {background: none; border: none; color: #333333; opacity: 0.6; font-size: 18px; padding: 4px 8px; box-shadow: none; border-radius: 4px; transition: all 0.2s ease;}
.Õºp .cm-panel.cm-search button[name="close"]:hover {background-color: #f5f5f5; color: #333333; opacity: 1; transform: scale(1.1); box-shadow: 0 2px 4px rgba(0,0,0,0.1);}
.Õºp .cm-panel.cm-search label {color: #333333; font-size: 12px; display: inline-flex; align-items: center; gap: 4px; cursor: pointer; user-select: none; white-space: nowrap; font-weight: 500;}
.Õºp .cm-panel.cm-search input[type="checkbox"] {width: 13px; height: 13px; cursor: pointer; accent-color: #ff6b6b;}
.Õºp .cm-searchMatch {background-color: rgba(0, 122, 204, 0.4); outline: 2px solid #007acc; border-radius: 2px; box-shadow: 0 0 0 1px rgba(0, 122, 204, 0.3);}
.Õºp .cm-searchMatch-selected {background-color: #007acc; color: #ffffff; outline: 2px solid #005a99; box-shadow: 0 0 4px rgba(0, 122, 204, 0.5);}
.Õºp .cm-panel button, .Õºp .cm-search button, .Õºp .cm-panel.cm-search button, .Õºp button[name="next"], .Õºp button[name="prev"], .Õºp button[name="select"], .Õºp button[name="replace"], .Õºp button[name="replaceAll"] {background-color: #007acc !important; border: 1px solid #007acc !important; color: #ffffff !important; border-radius: 6px !important; padding: 8px 16px !important; font-size: 12px !important; font-weight: 600 !important; text-transform: uppercase !important; letter-spacing: 0.5px !important;}
.Õºp .cm-panel button:hover, .Õºp .cm-search button:hover, .Õºp .cm-panel.cm-search button:hover, .Õºp button[name="next"]:hover, .Õºp button[name="prev"]:hover, .Õºp button[name="select"]:hover, .Õºp button[name="replace"]:hover, .Õºp button[name="replaceAll"]:hover {background-color: #005a99 !important; border-color: #005a99 !important;}
.Õºp button[class*="cm-"], .Õºp button[class*="search"], .Õºp .cm-editor button, .Õºp .CodeMirror button {background-color: #007acc !important; border: 1px solid #007acc !important; color: #ffffff !important;}
.Õºo {font-size: 14px; height: 100%;}
.Õºo .cm-content {padding: 16px; font-family: JetBrains Mono, Monaco, Consolas, monospace; line-height: 1.6; white-space: pre-wrap; word-break: break-word; overflow-wrap: break-word; hyphens: auto; max-width: 100%; overflow: hidden;}
.Õºo .cm-focused {outline: none;}
.Õºo .cm-editor {height: 100%;}
.Õºo .cm-scroller {font-family: JetBrains Mono, Monaco, Consolas, monospace; overflow: auto; white-space: pre-wrap; word-break: break-word; overflow-wrap: break-word; hyphens: auto; max-width: 100%;}
.Õºo .cm-selectionBackground {background: #ff0000 !important;}
.Õºo.cm-focused .cm-selectionBackground {background: #cc0000 !important;}
.Õºo .cm-selectionMatch {background: #ff0000 !important; border-radius: 2px;}
.Õº5 {color: #404740;}
.Õº6 {text-decoration: underline;}
.Õº7 {text-decoration: underline; font-weight: bold;}
.Õº8 {font-style: italic;}
.Õº9 {font-weight: bold;}
.Õºa {text-decoration: line-through;}
.Õºb {color: #708;}
.Õºc {color: #219;}
.Õºd {color: #164;}
.Õºe {color: #a11;}
.Õºf {color: #e40;}
.Õºg {color: #00f;}
.Õºh {color: #30a;}
.Õºi {color: #085;}
.Õºj {color: #167;}
.Õºk {color: #256;}
.Õºl {color: #00c;}
.Õºm {color: #940;}
.Õºn {color: #f00;}
.Õº4 .cm-line ::selection, .Õº4 .cm-line::selection {background-color: transparent !important;}
.Õº4 .cm-line {caret-color: transparent !important;}
.Õº4 .cm-content :focus::selection, .Õº4 .cm-content :focus ::selection {background-color: Highlight !important;}
.Õº4 .cm-content :focus {caret-color: initial !important;}
.Õº4 .cm-content {caret-color: transparent !important;}
</style>
<style>undefined</style>
<style type="text/css" data-vite-dev-id="/home/guren/work/scribble/src/index.css">/* Global Styles - Flat Design Philosophy */
* {
  box-sizing: border-box;
}

/* Remove shadows globally, but NOT filters (breaks syntax highlighting) */
body, div, section, article, aside, nav, header, footer, main,
h1, h2, h3, h4, h5, h6, p, blockquote, ul, ol, li, dl, dt, dd,
table, thead, tbody, tfoot, tr, th, td, form, fieldset, legend, label, input, button, select, textarea {
  box-shadow: none !important;
  text-shadow: none !important;
}

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #0d1117; /* GitHub Dark */
  color: #e6edf3;      /* GitHub Dark text */
}

/* Loading screen */
.loading-screen {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 14px;
  background: var(--theme-bg, #0d1117);
  color: var(--theme-text, #e6edf3);
}
.loading-logo {
  font-size: 28px;
  font-weight: 800;
  letter-spacing: 0.4px;
  color: var(--theme-accent, #7aa2f7);
}
.loading-spinner {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: conic-gradient(from 0deg, var(--theme-accent, #7aa2f7), transparent 60%);
  -webkit-mask: radial-gradient(circle 20px, transparent 98%, #000 100%);
  mask: radial-gradient(circle 20px, transparent 98%, #000 100%);
  animation: spin 900ms linear infinite;
  box-shadow: 0 0 0 1px rgba(255,255,255,0.02) inset;
}
.loading-hint { opacity: 0.75; font-size: 13px; }

@keyframes spin { to { transform: rotate(360deg); } }

#root {
  height: 100%;
}

/* CodeMirror Overrides */
.cm-editor {
  height: 100%;
}

.cm-scroller {
  font-family: 'JetBrains Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

/* KaTeX Styles */
.katex {
  font-size: 1.1em;
}

.katex-display {
  margin: 1.5em 0;
  text-align: center;
  overflow: visible !important; /* avoid scrollbars inside equations */
}

/* Prism Styles */
pre[class*="language-"] {
  margin: 1em 0;
  border-radius: 8px;
  overflow-x: auto;
}

code[class*="language-"] {
  font-family: 'JetBrains Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

/* Mermaid Styles */
.mermaid {
  text-align: center;
  margin: 1em 0;
}

/* Default hidden mobile blocker */
.mobile-blocker { display: none; }

/* Focus Styles */
*:focus {
  outline: 2px solid #7aa2f7;
  outline-offset: 2px;
}

/* Prevent resize handle from being tab-focusable */
[data-panel-resize-handle-id] {
  outline: none !important;
}

[data-panel-resize-handle-id]:focus {
  outline: none !important;
}

/* Selection Styles - Let CodeMirror handle editor selection */
/* Global selection for preview pane only */
.preview-wrapper ::selection {
  background: rgba(0, 122, 204, 0.15);
  color: inherit;
}

.preview-wrapper ::-moz-selection {
  background: rgba(0, 122, 204, 0.15);
  color: inherit;
}

/* Mobile blocker: hide app on small screens */
@media (max-width: 899px) {
  .app { display: none; }
  .mobile-blocker {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    inset: 0;
    width: 100vw;
    height: 100vh;
    padding: 24px;
    z-index: 9999;
    background: var(--theme-bg, #0d1117);
  }
  .mobile-blocker-card {
    background: linear-gradient(180deg, rgba(13,17,23,0.95) 0%, rgba(13,17,23,0.9) 100%);
    color: var(--theme-text, #e6edf3);
    border: 1px solid var(--theme-border, #30363d);
    border-radius: 12px;
    padding: 28px 24px;
    text-align: center;
    max-width: 520px;
    box-shadow: 0 18px 40px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.02) inset;
  }
  .mobile-blocker-card h2 {
    margin: 10px 0 8px;
    font-size: 20px;
    letter-spacing: 0.2px;
  }
  .mobile-blocker-card p {
    margin: 0 0 14px;
    opacity: 0.85;
  }
  .mobile-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 64px;
    height: 64px;
    border-radius: 9999px;
    margin: 0 auto 10px;
    color: var(--theme-accent, #7aa2f7);
    background: rgba(122,162,247,0.08);
    box-shadow: 0 8px 24px rgba(122,162,247,0.25);
  }
  .mobile-blocker-actions { margin-top: 6px; }
  .mobile-blocker-btn {
    background: var(--theme-accent, #7aa2f7);
    color: #0b1220;
    border: none;
    border-radius: 8px;
    padding: 10px 14px;
    font-weight: 600;
    cursor: pointer;
    transition: transform .08s ease, filter .2s ease;
  }
  .mobile-blocker-btn:hover { filter: brightness(1.05); }
  .mobile-blocker-btn:active { transform: translateY(1px); }
}

@media (min-width: 900px) {
  .mobile-blocker { display: none; }
}</style>
<style type="text/css" data-vite-dev-id="/home/guren/work/scribble/node_modules/katex/dist/katex.min.css">@font-face{font-family:KaTeX_AMS;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_AMS-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_AMS-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:700;src:url(/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:700;src:url(/node_modules/katex/dist/fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Fraktur-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Fraktur-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:700;src:url(/node_modules/katex/dist/fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Main-Bold.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Main-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:700;src:url(/node_modules/katex/dist/fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Main-Italic.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Main-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Main-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Main-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:700;src:url(/node_modules/katex/dist/fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Math-Italic.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Math-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:700;src:url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Bold.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:italic;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_SansSerif-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Script;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Script-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Script-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size1;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Size1-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Size1-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size2;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Size2-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Size2-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size3;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Size3-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Size3-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size4;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Size4-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Size4-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Typewriter;font-style:normal;font-weight:400;src:url(/node_modules/katex/dist/fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(/node_modules/katex/dist/fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(/node_modules/katex/dist/fonts/KaTeX_Typewriter-Regular.ttf) format("truetype")}.katex{font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0;text-rendering:auto}.katex *{-ms-high-contrast-adjust:none!important;border-color:currentColor}.katex .katex-version:after{content:"0.16.23"}.katex .katex-mathml{clip:rect(1px,1px,1px,1px);border:0;height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.katex .katex-html>.newline{display:block}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-style:italic;font-weight:700}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathboldfrak,.katex .textboldfrak{font-family:KaTeX_Fraktur;font-weight:700}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .mathsfit,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{border-collapse:collapse;display:inline-table;table-layout:fixed}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;position:relative;vertical-align:bottom}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;font-size:1px;min-width:2px;vertical-align:bottom;width:2px}.katex .vbox{align-items:baseline;display:inline-flex;flex-direction:column}.katex .hbox{width:100%}.katex .hbox,.katex .thinbox{display:inline-flex;flex-direction:row}.katex .thinbox{max-width:0;width:0}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .mspace{display:inline-block}.katex .clap,.katex .llap,.katex .rlap{position:relative;width:0}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{border:0 solid;display:inline-block;position:relative}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline{border-bottom-style:dashed;display:inline-block;width:100%}.katex .sqrt>.root{margin-left:.2777777778em;margin-right:-.5555555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.8333333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.1666666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.3333333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.6666666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.4566666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.1466666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.7142857143em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.8571428571em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.1428571429em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.2857142857em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.4285714286em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.7142857143em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.0571428571em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.4685714286em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.9628571429em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.5542857143em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.5555555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.6666666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.7777777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.8888888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.1111111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.3333333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.3044444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.7644444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.4166666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.5833333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.6666666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.8333333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.7283333333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.0733333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.3472222222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.4166666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.4861111111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.5555555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.6944444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.8333333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.4402777778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.7277777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.2893518519em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.3472222222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.4050925926em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.462962963em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.5208333333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.6944444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.8333333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.2002314815em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.4398148148em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.2410800386em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.2892960463em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.337512054em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.3857280617em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.4339440694em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.4821600771em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.5785920926em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.6943105111em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.8331726133em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.1996142719em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.2009646302em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.2411575563em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.2813504823em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.3215434084em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.3617363344em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.4019292605em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.4823151125em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.578778135em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.6945337621em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.8336012862em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{position:relative}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;min-width:1px}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;display:block;height:inherit;position:absolute;width:100%}.katex svg path{stroke:none}.katex img{border-style:none;max-height:none;max-width:none;min-height:0;min-width:0}.katex .stretchy{display:block;overflow:hidden;position:relative;width:100%}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{overflow:hidden;position:relative;width:100%}.katex .halfarrow-left{left:0;overflow:hidden;position:absolute;width:50.2%}.katex .halfarrow-right{overflow:hidden;position:absolute;right:0;width:50.2%}.katex .brace-left{left:0;overflow:hidden;position:absolute;width:25.1%}.katex .brace-center{left:25%;overflow:hidden;position:absolute;width:50%}.katex .brace-right{overflow:hidden;position:absolute;right:0;width:25.1%}.katex .x-arrow-pad{padding:0 .5em}.katex .cd-arrow-pad{padding:0 .55556em 0 .27778em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox,.katex .fcolorbox{border:.04em solid;box-sizing:border-box}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex .angl{border-right:.049em solid;border-top:.049em solid;box-sizing:border-box;margin-right:.03889em}.katex .anglpad{padding:0 .03889em}.katex .eqn-num:before{content:"(" counter(katexEqnNo) ")";counter-increment:katexEqnNo}.katex .mml-eqn-num:before{content:"(" counter(mmlEqnNo) ")";counter-increment:mmlEqnNo}.katex .mtr-glue{width:50%}.katex .cd-vert-arrow{display:inline-block;position:relative}.katex .cd-label-left{display:inline-block;position:absolute;right:calc(50% + .3em);text-align:left}.katex .cd-label-right{display:inline-block;left:calc(50% + .3em);position:absolute;text-align:right}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}.katex-display.leqno>.katex>.katex-html>.tag{left:0;right:auto}.katex-display.fleqn>.katex{padding-left:2em;text-align:left}body{counter-reset:katexEqnNo mmlEqnNo}
</style>
<style type="text/css" data-vite-dev-id="/home/guren/work/scribble/src/styles/shiki.css">.shiki {
  overflow-x: auto;
  border-radius: 8px;
  font-family: var(--font-mono, 'Fira Code', monospace);
  padding: 1rem;
  line-height: 1.5;
  scroll-behavior: smooth;
}

/* Sleek horizontal scrollbar for code blocks */
.shiki {
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: var(--accent, var(--accent, #7aa2f7)) transparent;
}
.shiki::-webkit-scrollbar { height: 10px; }
.shiki::-webkit-scrollbar-thumb {
  background-color: var(--accent, var(--accent, #7aa2f7)) !important;
  border-radius: 8px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
.shiki::-webkit-scrollbar-track { background: transparent !important; }

/* Keep Shiki's inline/token colors intact; avoid overriding span styles */

.copy-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: transparent;
  border: none;
  cursor: pointer;
  opacity: 0.6;
  transition: opacity 0.2s;
}
.copy-btn:hover {
  opacity: 1;
}


</style>
<style type="text/css" data-vite-dev-id="/home/guren/work/scribble/src/components/Editor.css">/* Editor Styles */
.editor-wrapper {
  position: relative;
  height: 100%;
  overflow: hidden;
}

.cm-editor {
  height: 100%;
  font-size: 14px;
  line-height: 1.5;
}

.cm-content {
  padding: 16px;
  min-height: 100%;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

.cm-focused {
  outline: none;
}

.cm-scroller {
  overflow: auto;
}

.cm-gutters {
  background-color: var(--theme-bg);
  border-right: 1px solid var(--theme-border);
  color: var(--theme-text);
  opacity: 0.6;
}

.cm-lineNumbers {
  color: var(--theme-text);
  opacity: 0.6;
}

.cm-cursor {
  border-left: 2px solid var(--theme-text);
}

.cm-selectionBackground {
  background: rgba(0, 122, 204, 0.28);
}

.cm-focused .cm-selectionBackground {
  background: rgba(0, 122, 204, 0.35);
}

.cm-selectionMatch {
  background: rgba(255, 196, 0, 0.35);
  border-radius: 2px;
}
</style>
<style type="text/css" data-vite-dev-id="/home/guren/work/scribble/src/App.css">/* App Styles */
.app {
  height: 100vh;
  display: flex;
  flex-direction: column;
  background: #f6f8fa;
  color: #24292e;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.app-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  background: #ffffff;
  border-bottom: 1px solid #e1e4e8;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  flex-shrink: 0;
}

.app-header h1 {
  margin: 0;
  font-size: 24px;
  font-weight: 700;
  background: linear-gradient(135deg, #0366d6 0%, #0256c7 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.app-controls {
  display: flex;
  align-items: center;
  gap: 24px;
}

.demo-btn {
  padding: 8px 16px;
  background: #0366d6;
  color: #ffffff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(3, 102, 214, 0.2);
}

.demo-btn:hover {
  background: #0256c7;
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(3, 102, 214, 0.3);
}

.demo-btn:active {
  transform: translateY(0);
  box-shadow: 0 1px 2px rgba(3, 102, 214, 0.2);
}

.loading {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-size: 18px;
  color: #0366d6;
}

/* Toolbar Styles */
.toolbar {
  display: flex;
  gap: 24px;
  padding: 12px 24px;
  background: #24283b;
  border-bottom: 1px solid var(--border-color, #565f89);
  flex-shrink: 0;
}

.toolbar-section {
  display: flex;
  gap: 8px;
  position: relative;
}

.toolbar-btn {
  padding: 8px 16px;
  background: #3b4252;
  color: #d8dee9;
  border: 1px solid #4c566a;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s ease;
}

.toolbar-btn:hover {
  background: #434c5e;
  border-color: #5e81ac;
  color: #88c0d0;
}

.toolbar-btn:active {
  background: #4c566a;
  transform: translateY(1px);
}

/* Export Dropdown */
.export-dropdown {
  position: relative;
}

.export-btn {
  display: flex;
  align-items: center;
  gap: 4px;
}

.export-menu {
  position: absolute;
  top: 100%;
  left: 0;
  background: #3b4252;
  border: none;
  border-radius: 6px;
  z-index: 1000;
  min-width: 120px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.export-option {
  display: block;
  width: 100%;
  padding: 8px 12px;
  background: transparent;
  color: #d8dee9;
  border: none;
  text-align: left;
  cursor: pointer;
  transition: background 0.2s ease;
}

.export-option:hover {
  background: #434c5e;
  color: #88c0d0;
}

.export-option:active {
  background: #4c566a;
}

/* Theme Picker Styles */
.theme-picker {
  display: flex;
  align-items: center;
  gap: 16px;
}

.theme-section {
  display: flex;
  align-items: center;
  gap: 8px;
}

.theme-picker label {
  font-size: 13px;
  font-weight: 600;
  color: #586069;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.theme-select {
  padding: 8px 12px;
  background: #ffffff;
  color: #24292e;
  border: 1px solid #d1d5da;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.15s ease;
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.theme-select:hover {
  border-color: #0366d6;
}

.theme-select:focus {
  outline: none;
  border-color: #0366d6;
  box-shadow: 0 0 0 3px rgba(3, 102, 214, 0.1);
}

.theme-btn {
  padding: 8px 16px;
  background: #0366d6;
  color: #ffffff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(3, 102, 214, 0.2);
}

.theme-btn:hover {
  background: #0256c7;
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(3, 102, 214, 0.3);
}

.theme-btn:active {
  background: #024ea4;
  transform: translateY(0);
  box-shadow: 0 1px 2px rgba(3, 102, 214, 0.2);
}

.theme-picker .export-dropdown {
  position: relative;
}

.theme-picker .export-menu {
  position: absolute;
  top: calc(100% + 4px);
  right: 0;
  background: #ffffff;
  border: 1px solid #e1e4e8;
  border-radius: 6px;
  box-shadow: 0 3px 12px rgba(0,0,0,0.15);
  z-index: 1000;
  min-width: 140px;
  overflow: hidden;
}


.theme-picker .export-option {
  display: block;
  width: 100%;
  padding: 10px 16px;
  background: transparent;
  color: #24292e;
  border: none;
  text-align: left;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 14px;
  font-weight: 500;
}

.theme-picker .export-option:hover {
  background: #f6f8fa;
  color: #0366d6;
}

.theme-picker .export-option:active {
  background: #e1e4e8;
}


/* App Content */
.app-content {
  flex: 1;
  overflow: hidden;
  width: 100%;
  height: 100%;
}

.editor-panel,
.preview-panel {
  display: flex;
  flex-direction: column;
  background: #ffffff;
  min-width: 0;
  overflow: hidden;
  width: 100%;
  height: 100%;
}

/* Resize Handle */
.resize-handle {
  background: #e1e4e8;
  width: 4px;
  cursor: col-resize;
  transition: all 0.2s ease;
  position: relative;
  outline: none !important;
}

.resize-handle:hover {
  background: #0366d6;
  width: 6px;
}

.resize-handle:active {
  background: #0256c7;
  opacity: 0.8;
}

.resize-handle:focus {
  outline: none !important;
}

.panel-header {
  padding: 12px 16px;
  background: #f6f8fa;
  border-bottom: 1px solid #e1e4e8;
  font-size: 12px;
  font-weight: 700;
  color: #586069;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.editor-container {
  flex: 1;
  min-width: 0; /* Prevents overflow */
  overflow: hidden; /* Prevent horizontal scroll */
  width: 100%;
  height: 100%;
}

.editor-container .cm-editor {
  height: 100%;
  max-width: 100% !important;
  overflow: hidden !important;
}

.editor-container .cm-content {
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: break-word !important;
  hyphens: auto !important;
  max-width: 100% !important;
  overflow: hidden !important;
}

.editor-container .cm-scroller {
  font-family: 'JetBrains Mono', Monaco, Consolas, monospace;
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: break-word !important;
  hyphens: auto !important;
  max-width: 100% !important;
}

.preview-wrapper {
  flex: 1;
  overflow: auto;
  width: 100%;
  height: 100%;
  background: var(--theme-bg, #ffffff) !important;
  color: var(--theme-text, #000000) !important;
}

/* Mobile Responsiveness & Zooming */
html {
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}

body {
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  touch-action: manipulation;
}

/* Responsive Design */
@media (max-width: 768px) {
  .app-content {
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
  }
  
  .editor-panel,
  .preview-panel {
    min-height: 50vh;
    max-height: 50vh;
    overflow: hidden;
  }
  
  .resize-handle {
    width: 100%;
    height: 4px;
    cursor: row-resize;
    min-height: 4px;
  }
  
  .app-header {
    flex-direction: column;
    gap: 16px;
    align-items: stretch;
    padding: 12px 16px;
  }
  
  .app-controls {
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 12px;
  }
  
  .toolbar {
    flex-wrap: wrap;
    gap: 12px;
    padding: 8px 16px;
  }
  
  .toolbar-section {
    flex-wrap: wrap;
  }
  
  /* Mobile editor improvements */
  .editor-container {
    font-size: 16px; /* Prevent zoom on iOS */
  }
  
  .editor-container .cm-content {
    padding: 12px;
    font-size: 16px;
  }
  
  /* Mobile preview improvements */
  .preview-wrapper {
    font-size: 16px;
    line-height: 1.5;
    padding: 12px;
  }
  
  
  /* Mobile math */
  .katex {
    font-size: 1em;
    max-width: 100%;
    overflow: visible !important; /* prevent inner scrollbars */
  }
  
}

@media (max-width: 480px) {
  .app-header {
    padding: 8px 12px;
  }
  
  .app-header h1 {
    font-size: 20px;
  }
  
  .toolbar {
    padding: 6px 12px;
    gap: 8px;
  }
  
  .app-controls {
    flex-direction: column;
    gap: 8px;
  }
  
  .theme-picker {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .theme-select {
    font-size: 14px;
    padding: 6px 8px;
  }
  
  .demo-btn, .theme-btn {
    font-size: 12px;
    padding: 6px 12px;
  }
  
  /* Extra small screens */
  .editor-container .cm-content {
    padding: 8px;
    font-size: 14px;
  }
  
  .preview-wrapper {
    padding: 8px;
    font-size: 14px;
  }
}

/* Touch-friendly interactions */
@media (hover: none) and (pointer: coarse) {
  .resize-handle {
    min-height: 8px;
    min-width: 8px;
  }
  
  .toolbar-btn, .demo-btn, .theme-btn {
    min-height: 44px;
    min-width: 44px;
  }
  
  .theme-select {
    min-height: 44px;
  }
}

/* High DPI displays */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .editor-container .cm-content {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}


/* Scrollbar Styling */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: #f6f8fa;
}

::-webkit-scrollbar-thumb {
  background: #d1d5da;
  border-radius: 5px;
  border: 2px solid #f6f8fa;
}

::-webkit-scrollbar-thumb:hover {
  background: #959da5;
}
</style>
<style>
          /* Global CodeMirror button overrides - nuclear option */
          .cm-panel button,
          .cm-search button,
          .cm-panel.cm-search button,
          button[name="next"],
          button[name="prev"],
          button[name="select"],
          button[name="replace"],
          button[name="replaceAll"],
          .CodeMirror button,
          .cm-editor button {
            background-color: #007acc !important;
            background: #007acc !important;
            border: 1px solid #007acc !important;
            border-color: #007acc !important;
            color: #ffffff !important;
            border-radius: 6px !important;
            padding: 8px 16px !important;
            font-size: 12px !important;
            font-weight: 600 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.5px !important;
          }
          
          .cm-panel button:hover,
          .cm-search button:hover,
          .cm-panel.cm-search button:hover,
          button[name="next"]:hover,
          button[name="prev"]:hover,
          button[name="select"]:hover,
          button[name="replace"]:hover,
          button[name="replaceAll"]:hover,
          .CodeMirror button:hover,
          .cm-editor button:hover {
            background-color: #005a99 !important;
            background: #005a99 !important;
            border-color: #005a99 !important;
          }
          
          /* Exception for close button */
          button[name="close"] {
            background: none !important;
            background-color: transparent !important;
            border: none !important;
            color: #333333 !important;
            padding: 4px 8px !important;
          }
          
          button[name="close"]:hover {
            background-color: #f5f5f5 !important;
            background: #f5f5f5 !important;
          }
          
          /* Jump highlight animation */
          .cm-jump-highlight {
            background: rgba(122, 162, 247, 0.3) !important;
            animation: fadeOut 0.8s forwards;
          }
          
          @keyframes fadeOut {
            to { background: transparent !important; }
          }
          
          /* Nuclear selection highlighting */
          .cm-selectionBackground,
          .cm-editor .cm-selectionBackground,
          .cm-content .cm-selectionBackground,
          .cm-line .cm-selectionBackground {
            background: #ff0000 !important;
            background-color: #ff0000 !important;
          }
          
          .cm-focused .cm-selectionBackground,
          .cm-editor.cm-focused .cm-selectionBackground,
          .cm-content.cm-focused .cm-selectionBackground {
            background: #cc0000 !important;
            background-color: #cc0000 !important;
          }
          
          .cm-selectionMatch,
          .cm-editor .cm-selectionMatch,
          .cm-content .cm-selectionMatch {
            background: #ff0000 !important;
            background-color: #ff0000 !important;
          }
        </style>
<style>
        .preview-wrapper {
          box-shadow: none;
          text-shadow: none;
          padding: 20px;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
          line-height: 1.6;
          color: var(--theme-text);
          background: var(--theme-bg);
          height: 100%;
          overflow-y: auto;
          overflow-x: auto;
        }

        /* Sleek scrollbars in preview */
        .preview-wrapper,
        .preview-wrapper pre,
        .preview-wrapper .shiki {
          scrollbar-width: thin; /* Firefox */
          scrollbar-color: var(--theme-accent) transparent;
        }
        .preview-wrapper::-webkit-scrollbar { height: 10px; width: 10px; }
        .preview-wrapper::-webkit-scrollbar-thumb {
          background-color: var(--theme-accent);
          border-radius: 8px;
          border: 2px solid transparent;
          background-clip: padding-box;
        }
        .preview-wrapper::-webkit-scrollbar-track { background: transparent; }

        .preview-wrapper pre::-webkit-scrollbar,
        .preview-wrapper .shiki::-webkit-scrollbar {
          height: 8px;
          width: 8px;
        }
        .preview-wrapper pre::-webkit-scrollbar-thumb,
        .preview-wrapper .shiki::-webkit-scrollbar-thumb {
          background-color: var(--accent);
          border-radius: 6px;
        }
        .preview-wrapper pre::-webkit-scrollbar-track,
        .preview-wrapper .shiki::-webkit-scrollbar-track {
          background: var(--accent);
        }
        
        .preview-wrapper h1, .preview-wrapper h2, .preview-wrapper h3, 
        .preview-wrapper h4, .preview-wrapper h5, .preview-wrapper h6 {
          margin-top: 1.5em;
          margin-bottom: 0.5em;
          font-weight: 600;
          line-height: 1.25;
          color: var(--theme-text);
        }
        
        .preview-wrapper h1 { font-size: 2em; border-bottom: 1px solid var(--theme-border); padding-bottom: 0.3em; }
        .preview-wrapper h2 { font-size: 1.5em; border-bottom: 1px solid var(--theme-border); padding-bottom: 0.3em; }
        .preview-wrapper h3 { font-size: 1.25em; }
        .preview-wrapper h4 { font-size: 1em; }
        .preview-wrapper h5 { font-size: 0.875em; }
        .preview-wrapper h6 { font-size: 0.85em; color: var(--theme-text); opacity: 0.8; }
        
        .preview-wrapper p {
          margin: 1em 0;
          color: var(--theme-text);
        }
        
        .preview-wrapper ul, .preview-wrapper ol {
          margin: 1em 0;
          padding-left: 2em;
        }
        
        .preview-wrapper li {
          margin: 0.25em 0;
          color: var(--theme-text);
        }
        
        .preview-wrapper blockquote {
          margin: 1em 0;
          padding: 0 1em;
          border-left: 4px solid var(--theme-accent);
          color: var(--theme-text);
          opacity: 0.8;
        }
        
        .preview-wrapper table {
          border-collapse: collapse;
          width: 100%;
          margin: 1em 0;
        }
        
        .preview-wrapper th, .preview-wrapper td {
          border: 1px solid var(--theme-border);
          padding: 0.5em;
          text-align: left;
        }
        
        .preview-wrapper th {
          background: var(--code-bg);
          font-weight: 600;
          color: var(--theme-text);
        }
        
        .preview-wrapper td {
          background: var(--theme-bg);
          color: var(--theme-text);
        }
        
        /* Inline code styling (avoid affecting Shiki blocks) */
        .preview-wrapper :not(pre) > code {
          background: var(--code-bg);
          color: var(--code-text);
          padding: 0.2em 0.4em;
          border-radius: 3px;
          font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
          font-size: 0.9em;
        }
        
        .preview-wrapper pre:not(.shiki) {
          background: var(--code-bg);
          color: var(--code-text);
          padding: 1em;
          border-radius: 6px;
          overflow-x: auto;
          margin: 1em 0;
          font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
          line-height: 1.4;
          border: 1px solid var(--theme-border);
        }
        
        .preview-wrapper pre:not(.shiki) code {
          background: none;
          padding: 0;
          border-radius: 0;
          color: inherit;
        }
        
        .preview-wrapper a {
          color: var(--theme-accent);
          text-decoration: none;
        }
        
        .preview-wrapper a:hover {
          text-decoration: underline;
        }
        
        .preview-wrapper hr {
          border: none;
          border-top: 1.5px solid var(--theme-accent);
          margin: 2em 0;
        }
        
        .preview-wrapper img {
          max-width: 100%;
          height: auto;
          border-radius: 4px;
          margin: 1em 0;
        }

        /* Ensure KaTeX lines do not break awkwardly */
        .katex { white-space: normal; }
        .katex-display { overflow-x: auto; }
        
        .mermaid-block {
          margin: 1em 0;
          text-align: center;
          min-height: 24px;
          overflow: visible;
        }
        .mermaid-block svg { max-width: 100%; height: auto; }
        .mermaid-block .foreignObject { overflow: visible; }

        /* Keep SVG responsive */
        .mermaid-block .flowchartTitleText { white-space: nowrap; }

        /* Fallback: force readable label text if a theme hides it */
        .mermaid-block .label text,
        .mermaid-block .label span,
        .mermaid-block .nodeLabel,
        .mermaid-block .edgeLabel text {
          fill: var(--theme-text) !important;
          color: var(--theme-text) !important;
        }
        
        /* Slightly compact default text to reduce overall width */
        .mermaid-block svg text {
          font-size: 12px;
        }
        
        /* Reduce extra paddings often added around diagrams */
        .mermaid-block svg { padding: 0; }
        
        }
        
        .math-block {
          margin: 1em 0;
          text-align: center;
        }
        
        .code-block {
          margin: 1em 0;
          border-radius: 6px;
          overflow: hidden;
          border: 1px solid var(--theme-border);
        }
        
        /* KaTeX overflow fixes: prevent per-equation scrollbars */
        .preview-wrapper .katex,
        .preview-wrapper .katex-display,
        .preview-wrapper .katex-display > .katex,
        .preview-wrapper .katex-display .katex-html {
          overflow: visible !important;
          max-width: 100%;
        }
        .preview-wrapper .katex-display > .katex {
          white-space: normal !important;
        }
        
        /* Print styles */
        @page {
          size: A4;
          margin: 0;
        }
        
        @media print {
          html, body, .preview-wrapper {
            margin: 0 !important;
            padding: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: var(--theme-bg) !important;
            color: var(--theme-text) !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
            color-adjust: exact !important;
          }
          
          .preview-wrapper, .preview-wrapper * {
            background-color: inherit !important;
            color: inherit !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          
          pre, code, .code-block {
            background: var(--code-bg) !important;
            color: var(--code-text) !important;
            box-shadow: none !important;
            border: none !important;
            opacity: 1 !important;
            isolation: isolate;
            page-break-inside: avoid;
          }
          
          mjx-container, mjx-container * {
            fill: currentColor !important;
            stroke: currentColor !important;
            color: var(--theme-text) !important;
            opacity: 1 !important;
            filter: none !important;
            text-shadow: none !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          
          mjx-container svg {
            shape-rendering: geometricPrecision !important;
            text-rendering: geometricPrecision !important;
            image-rendering: optimizeQuality !important;
          }
          
          .mermaid-block svg {
            vector-effect: non-scaling-stroke;
            max-width: 100%;
            height: auto;
          }
          
          mjx-container, .mermaid-block, pre, code {
            page-break-inside: avoid !important;
          }
        }
      </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.23/dist/katex.min.css">
  <style>
    :root { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    body {
      background: rgb(10, 10, 10);
      color: rgb(255, 255, 255);
      font-family: system-ui, sans-serif;
      margin: 0;
    }
    .preview-wrapper { padding: 20px; overflow-x: auto; }

    /* Sleek horizontal scrollbar styling */
    .preview-wrapper,
    .preview-wrapper pre,
    .preview-wrapper .shiki {
      scrollbar-width: thin; /* Firefox */
      scrollbar-color: var(--code-accent, var(--theme-accent, #7aa2f7)) transparent;
    }
    .preview-wrapper::-webkit-scrollbar { height: 10px; width: 10px; }
    .preview-wrapper::-webkit-scrollbar-thumb {
      background-color: var(--code-accent, var(--theme-accent, #7aa2f7));
      border-radius: 8px;
      border: 2px solid transparent;
      background-clip: padding-box;
    }
    .preview-wrapper::-webkit-scrollbar-track { background: transparent; }
  </style>
</head>
<body>
<div class="preview-wrapper" style="--theme-bg: #0a0a0a; --theme-text: #ffffff; --code-bg: #161b22; --code-text: #ffffff; --theme-border: #30363d; --theme-accent: #ff6b6b;"><h1 data-pos-start="1" data-pos-end="1">Matrix Exponentiation (When DP is Naive, Use Linear Algebra)</h1>
<p data-pos-start="3" data-pos-end="3">Yep, you read that absolutely right: there exist problems where your clever dynamic programming solution is actually the <strong data-pos-start="3" data-pos-end="3">naive</strong> solution.</p>
<p data-pos-start="5" data-pos-end="5">Don‚Äôt believe me? Try solving this Fibonacci problem, <a href="https://cses.fi/problemset/task/1722" data-pos-start="5" data-pos-end="5">https://cses.fi/problemset/task/1722</a> with DP &amp; lmk if you get DP or not.</p>
<hr data-pos-start="7" data-pos-end="7">
<h2 data-pos-start="9" data-pos-end="9">0) <strong data-pos-start="9" data-pos-end="9">Introduction</strong></h2>
<p data-pos-start="11" data-pos-end="11">So what the hell is matrix exponentiation and why do CP grinders love it?</p>
<p data-pos-start="13" data-pos-end="13">First step: understand <strong data-pos-start="13" data-pos-end="13">linear recurrences</strong>.</p>
<hr data-pos-start="15" data-pos-end="15">
<h3 data-pos-start="17" data-pos-end="17"><strong data-pos-start="17" data-pos-end="17">Linear Recurrence Refresher</strong></h3>
<p data-pos-start="19" data-pos-end="20">A <strong data-pos-start="19" data-pos-end="19">recurrence relation</strong> defines each term of a sequence from previous ones.<br data-pos-start="19" data-pos-end="20">
A <strong data-pos-start="20" data-pos-end="20">linear recurrence</strong> means the next term is a <strong data-pos-start="20" data-pos-end="20">linear combination</strong> of the last <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> terms:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.68em; vertical-align: -0.59em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.09em;"><span style="top: -3.68em;"><span class="pstrut" style="height: 3.68em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner">‚ãØ</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span><span style="top: -3.09em;"><span class="pstrut" style="height: 3.68em;"></span><span class="stretchy fbox" style="height: 1.68em; border-style: solid; border-width: 0.04em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.59em;"><span></span></span></span></span></span></span></span></span></span>
<ul data-pos-start="26" data-pos-end="28">
<li data-pos-start="26" data-pos-end="26"><strong data-pos-start="26" data-pos-end="26">Linear</strong> = only ‚Äúcoefficient <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">√ó</span></span></span></span> old term‚Äù plus additions; no squaring, no <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">/</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">max</span></span></span></span>.</li>
<li data-pos-start="27" data-pos-end="27">The number of past terms (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span>) is the <strong data-pos-start="27" data-pos-end="27">order</strong>.</li>
<li data-pos-start="28" data-pos-end="28">Once you know the first <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> values, the rest is determined.</li>
</ul>
<p data-pos-start="30" data-pos-end="30"><strong data-pos-start="30" data-pos-end="30">Classic examples</strong></p>
<ul data-pos-start="32" data-pos-end="34">
<li data-pos-start="32" data-pos-end="32">Fibonacci: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span>.</li>
<li data-pos-start="33" data-pos-end="33">Tribonacci: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>.</li>
<li data-pos-start="34" data-pos-end="34">Weighted: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span>.</li>
</ul>
<p data-pos-start="36" data-pos-end="36"><strong data-pos-start="36" data-pos-end="36">Non-examples (nonlinear)</strong></p>
<ul data-pos-start="38" data-pos-end="40">
<li data-pos-start="38" data-pos-end="38"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span>.</li>
<li data-pos-start="39" data-pos-end="39"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.</li>
<li data-pos-start="40" data-pos-end="40"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">min</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)}</span></span></span></span>.</li>
</ul>
<p data-pos-start="42" data-pos-end="42"><strong data-pos-start="42" data-pos-end="42">Big picture:</strong> future <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">=</span></span></span></span> weighted sum of past.</p>
<p data-pos-start="44" data-pos-end="45"><strong data-pos-start="44" data-pos-end="44">Note:</strong>
All linear recurrence problems are DP problems -&gt; you can optimize with matrix exponentials. But not all DP problems have a linear recurrence structure.</p>
<hr data-pos-start="47" data-pos-end="47">
<h3 data-pos-start="49" data-pos-end="49"><strong data-pos-start="49" data-pos-end="49">Why Matrix Exponentiation?</strong></h3>
<p data-pos-start="51" data-pos-end="51">Linear recurrences can be written as a matrix multiplying a <strong data-pos-start="51" data-pos-end="51">state vector</strong>. Instead of computing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> step by step (which dies at <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚àº</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span></span></span></span></span></span></span></span>), raise the matrix to a power with <strong data-pos-start="51" data-pos-end="51">binary exponentiation</strong> and jump straight there.</p>
<p data-pos-start="53" data-pos-end="54"><strong data-pos-start="53" data-pos-end="53">Pipeline:</strong><br data-pos-start="53" data-pos-end="54">
Recurrence <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel" style="">‚Üí</span></span></span></span> State Vector <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">‚Üí</span></span></span></span> Transition Matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">‚Üí</span></span></span></span> Fast Exponentiation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">‚Üí</span></span></span></span> Result.</p>
<p data-pos-start="56" data-pos-end="57"><strong data-pos-start="56" data-pos-end="56">What is Matrix Exponentiation?</strong><br data-pos-start="56" data-pos-end="57">
Take a linear recurrence/DP and rewrite it as</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen" style="">(</span><span class="mord mathnormal">n</span><span class="mclose" style="">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen" style="">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="61" data-pos-end="61">Then jump to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="">n</span></span></span></span> by computing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord" style=""><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> (or <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>, see indexing below).</p>
<p data-pos-start="63" data-pos-end="64"><strong data-pos-start="63" data-pos-end="63">Why Is It Useful?</strong><br data-pos-start="63" data-pos-end="64">
If you only need the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‚Äëth value and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> is massive (e.g., <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span></span></span></span></span></span></span></span>), simulating every step <strong data-pos-start="64" data-pos-end="64">dies in brute</strong>. Raising <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span> with fast (binary) exponentiation is easy.</p>
<hr data-pos-start="66" data-pos-end="66">
<h2 data-pos-start="68" data-pos-end="68">1) <strong data-pos-start="68" data-pos-end="68">Speed First: Why Binary Exponentiation Is Stupid Fast</strong></h2>
<p data-pos-start="70" data-pos-end="70"><strong data-pos-start="70" data-pos-end="70">Goal:</strong> compute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord" style=""><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span></span></span> without multiplying by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> times.</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8641em;"></span><span class="mord" style=""><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">15</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8641em;"></span><span class="mord" style=""><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="74" data-pos-end="74">(Powers of the <strong data-pos-start="74" data-pos-end="74">same</strong> matrix commute, so order doesn‚Äôt matter.)</p>
<p data-pos-start="76" data-pos-end="77"><strong data-pos-start="76" data-pos-end="76">Why it‚Äôs fast.</strong><br data-pos-start="76" data-pos-end="77">
You do <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen" style="">(</span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> squarings and at most <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen" style="">(</span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> multiplies to combine them.</p>
<p data-pos-start="79" data-pos-end="79">With naive <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> multiply at <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, total is <strong data-pos-start="79" data-pos-end="79"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></strong>.</p>
<p data-pos-start="81" data-pos-end="81">Rule of thumb: good for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.9592em; vertical-align: -0.2296em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel amsrm">‚â≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">50</span></span></span></span> per test (constraints matter).</p>
<p data-pos-start="83" data-pos-end="83"><strong data-pos-start="83" data-pos-end="83">Minimal code</strong></p>
<div class="code-container" style="position: relative; --accent: #89ddff;"><div class="shiki-block"><pre class="shiki material-theme-darker" style="background-color:#212121;color:#EEFFFF" tabindex="0"><code><span class="line"><span style="color:#FFCB6B">Matrix</span><span style="color:#82AAFF"> mpow</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Matrix</span><span style="color:#EEFFFF;font-style:italic"> base</span><span style="color:#89DDFF">,</span><span style="color:#C792EA"> long</span><span style="color:#C792EA"> long</span><span style="color:#EEFFFF;font-style:italic"> p</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">    Matrix </span><span style="color:#82AAFF">ans</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">base</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">n</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> base</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">mod</span><span style="color:#89DDFF">,</span><span style="color:#545454;font-style:italic"> /*identity=*/</span><span style="color:#89DDFF">true);</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    while</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">p </span><span style="color:#89DDFF">&gt;</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#89DDFF"> (</span><span style="color:#F07178">p </span><span style="color:#89DDFF">&amp;</span><span style="color:#F78C6C"> 1LL</span><span style="color:#89DDFF">)</span><span style="color:#F07178"> ans </span><span style="color:#89DDFF">=</span><span style="color:#F07178"> ans </span><span style="color:#89DDFF">*</span><span style="color:#F07178"> base</span><span style="color:#89DDFF">;</span><span style="color:#545454;font-style:italic">  // include this power if current bit is 1</span></span>
<span class="line"><span style="color:#F07178">        base </span><span style="color:#89DDFF">=</span><span style="color:#F07178"> base </span><span style="color:#89DDFF">*</span><span style="color:#F07178"> base</span><span style="color:#89DDFF">;</span><span style="color:#545454;font-style:italic">             // square: T -&gt; T^2 -&gt; T^4 -&gt; ...</span></span>
<span class="line"><span style="color:#F07178">        p </span><span style="color:#89DDFF">&gt;&gt;=</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">;</span><span style="color:#545454;font-style:italic">                        // shift exponent right</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#EEFFFF"> ans</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre></div><button class="copy-btn" title="Copy" aria-label="Copy code"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div>
<hr data-pos-start="96" data-pos-end="96">
<h2 data-pos-start="98" data-pos-end="98">2) <strong data-pos-start="98" data-pos-end="98">From DP to Linear Algebra (General Recipe)</strong></h2>
<p data-pos-start="100" data-pos-end="100">Start with a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span>‚Äëterm linear recurrence:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen" style="">(</span><span class="mord mathnormal" style="">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen" style="">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord" style="">1</span><span class="mclose" style="">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin" style="">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord" style="">2</span><span class="mclose" style="">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin" style="">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="minner" style="">‚ãØ</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="105" data-pos-end="105"><strong data-pos-start="105" data-pos-end="105">State vector</strong> = just enough info to advance one step:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text" style=""><span class="mord">State</span></span><span class="mopen" style="">(</span><span class="mord mathnormal">n</span><span class="mclose" style="">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 5.46em; vertical-align: -2.48em;"></span><span class="minner" style=""><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span style="width: 0.667em; height: 5.4em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="5.400em" viewBox="0 0 667 5400"><path d="M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span style="width: 0.667em; height: 5.4em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="5.400em" viewBox="0 0 667 5400"><path d="M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1800 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="116" data-pos-end="116">There‚Äôs a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> <strong data-pos-start="116" data-pos-end="116">transition (companion) matrix</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span> such that</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 6.66em; vertical-align: -3.08em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.55em;"><span style="top: -5.55em;"><span class="pstrut" style="height: 8.6em;"></span><span style="width: 0.667em; height: 6.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.600em" viewBox="0 0 667 6600"><path d="M403 1759 V84 H666 V0 H319 V1759 v3000 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v3000 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.05em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.4275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span><span style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -4.0275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -2.1675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -0.9675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.4275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span><span style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -4.0275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -2.1675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -0.9675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.24em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span><span style="top: -5.04em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span><span style="top: -3.84em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span><span style="top: -1.98em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ã±</span></span></span><span style="top: -0.78em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.4275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -4.0275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -2.1675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -0.9675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.4275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span><span style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -4.0275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -2.1675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -0.9675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.55em;"><span style="top: -5.55em;"><span class="pstrut" style="height: 8.6em;"></span><span style="width: 0.667em; height: 6.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.600em" viewBox="0 0 667 6600"><path d="M347 1759 V0 H0 V84 H263 V1759 v3000 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v3000 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.05em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="129" data-pos-end="129">Unroll:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight" style="margin-right: 0.1952em;"></span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="134" data-pos-end="134"><strong data-pos-start="134" data-pos-end="134">When is it <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> vs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>?</strong></p>
<ul data-pos-start="135" data-pos-end="136">
<li data-pos-start="135" data-pos-end="135">Base at <strong data-pos-start="135" data-pos-end="135">step 1</strong> (you know <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen" style="">(</span><span class="mord">1</span><span class="mclose" style="">)</span></span></span></span>) <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">‚áí</span></span></span></span> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</li>
<li data-pos-start="136" data-pos-end="136">Base at <strong data-pos-start="136" data-pos-end="136">step 0</strong> (you know <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen" style="">(</span><span class="mord">0</span><span class="mclose" style="">)</span></span></span></span>) <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">‚áí</span></span></span></span> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span>.</li>
</ul>
<p data-pos-start="138" data-pos-end="138">It‚Äôs just indexing. Align it with your base case. <strong data-pos-start="138" data-pos-end="138">Don‚Äôt overthink</strong>‚Äîpick the natural base.</p>
<hr data-pos-start="140" data-pos-end="140">
<h2 data-pos-start="142" data-pos-end="142">3) <strong data-pos-start="142" data-pos-end="142">Worked Example: Fibonacci (2√ó2)</strong></h2>
<p data-pos-start="144" data-pos-end="144">Recurrence: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span>, with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span>.</p>
<p data-pos-start="146" data-pos-end="146"><strong data-pos-start="146" data-pos-end="146">State and Transition</strong></p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="161" data-pos-end="161"><strong data-pos-start="161" data-pos-end="161">Check</strong></p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="169" data-pos-end="169">So the recurrence matches.</p>
<p data-pos-start="171" data-pos-end="171"><strong data-pos-start="171" data-pos-end="171">Base case and small test</strong></p>
<p data-pos-start="173" data-pos-end="173">Pick base</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span></span></span></span></span>
<p data-pos-start="177" data-pos-end="177">so</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="182" data-pos-end="182">Small check:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚áí</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord">5</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">5.</span></span></span></span></span>
<h3 data-pos-start="189" data-pos-end="189"><strong data-pos-start="189" data-pos-end="189">Fibonacci code (clean)</strong></h3>
<div class="code-container" style="position: relative; --accent: #89ddff;"><div class="shiki-block"><pre class="shiki material-theme-darker" style="background-color:#212121;color:#EEFFFF" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">#include</span><span style="color:#89DDFF"> &lt;</span><span style="color:#C3E88D">iostream</span><span style="color:#89DDFF">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">#include</span><span style="color:#89DDFF"> &lt;</span><span style="color:#C3E88D">vector</span><span style="color:#89DDFF">&gt;</span></span>
<span class="line"><span style="color:#F78C6C">using</span><span style="color:#C792EA"> namespace</span><span style="color:#FFCB6B"> std</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">using</span><span style="color:#FFCB6B"> ll</span><span style="color:#89DDFF"> =</span><span style="color:#C792EA"> long</span><span style="color:#C792EA"> long</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#C792EA"> long</span><span style="color:#C792EA"> long</span><span style="color:#EEFFFF"> MOD </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">'</span><span style="color:#F78C6C">000</span><span style="color:#89DDFF">'</span><span style="color:#F78C6C">000</span><span style="color:#89DDFF">'</span><span style="color:#F78C6C">007LL</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">struct</span><span style="color:#FFCB6B"> Matrix</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">    int</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">    ll mod</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">    vector</span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178">vector</span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178">ll</span><span style="color:#89DDFF">&gt;&gt;</span><span style="color:#F07178"> a</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#82AAFF">    Matrix</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">int</span><span style="color:#EEFFFF;font-style:italic"> n</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> ll</span><span style="color:#EEFFFF;font-style:italic"> mod</span><span style="color:#89DDFF">,</span><span style="color:#C792EA"> bool</span><span style="color:#EEFFFF;font-style:italic"> ident</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> false)</span><span style="color:#89DDFF"> :</span><span style="color:#82AAFF"> n</span><span style="color:#89DDFF">(</span><span style="color:#F07178">n</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF"> mod</span><span style="color:#89DDFF">(</span><span style="color:#F07178">mod</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF"> a</span><span style="color:#89DDFF">(</span><span style="color:#F07178">n</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> vector</span><span style="color:#89DDFF">&lt;</span><span style="color:#FFCB6B">ll</span><span style="color:#89DDFF">&gt;(</span><span style="color:#F07178">n</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">))</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#89DDFF"> (</span><span style="color:#F07178">ident</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF;font-style:italic"> for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#F07178"> i </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#F07178"> i </span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#F07178">i</span><span style="color:#89DDFF">)</span><span style="color:#EEFFFF"> a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">i</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#FFCB6B">    Matrix</span><span style="color:#F78C6C"> operator</span><span style="color:#FFCB6B">*</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">const</span><span style="color:#FFCB6B"> Matrix</span><span style="color:#C792EA">&amp;</span><span style="color:#EEFFFF;font-style:italic"> o</span><span style="color:#89DDFF">)</span><span style="color:#C792EA"> const</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">        Matrix </span><span style="color:#82AAFF">r</span><span style="color:#89DDFF">(</span><span style="color:#F07178">n</span><span style="color:#89DDFF">,</span><span style="color:#F07178"> mod</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#F07178"> i </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#F07178"> i </span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#F07178">i</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#F07178"> k </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#F07178"> k </span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#F07178">k</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF;font-style:italic"> if</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">k</span><span style="color:#89DDFF">])</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">                ll aik </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">k</span><span style="color:#89DDFF">];</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">                for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#F07178"> j </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#F07178"> j </span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#F07178">j</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">                    r</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">j</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">r</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">j</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> +</span><span style="color:#F07178"> aik </span><span style="color:#89DDFF">*</span><span style="color:#EEFFFF"> o</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">k</span><span style="color:#89DDFF">][</span><span style="color:#F07178">j</span><span style="color:#89DDFF">])</span><span style="color:#89DDFF"> %</span><span style="color:#F07178"> mod</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">                }</span></span>
<span class="line"><span style="color:#89DDFF">            }</span></span>
<span class="line"><span style="color:#89DDFF">        }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#F07178"> r</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B">Matrix</span><span style="color:#82AAFF"> mpow</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Matrix</span><span style="color:#EEFFFF;font-style:italic"> base</span><span style="color:#89DDFF">,</span><span style="color:#C792EA"> long</span><span style="color:#C792EA"> long</span><span style="color:#EEFFFF;font-style:italic"> p</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">    Matrix </span><span style="color:#82AAFF">ans</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">base</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">n</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> base</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">mod</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> true);</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    while</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">p </span><span style="color:#89DDFF">&gt;</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#89DDFF"> (</span><span style="color:#F07178">p </span><span style="color:#89DDFF">&amp;</span><span style="color:#F78C6C"> 1LL</span><span style="color:#89DDFF">)</span><span style="color:#F07178"> ans </span><span style="color:#89DDFF">=</span><span style="color:#F07178"> ans </span><span style="color:#89DDFF">*</span><span style="color:#F07178"> base</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">        base </span><span style="color:#89DDFF">=</span><span style="color:#F07178"> base </span><span style="color:#89DDFF">*</span><span style="color:#F07178"> base</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">        p </span><span style="color:#89DDFF">&gt;&gt;=</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#EEFFFF"> ans</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">int</span><span style="color:#82AAFF"> main</span><span style="color:#89DDFF">()</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#FFCB6B">    ios</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">sync_with_stdio</span><span style="color:#89DDFF">(false);</span></span>
<span class="line"><span style="color:#EEFFFF">    cin</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">tie</span><span style="color:#89DDFF">(nullptr);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    long</span><span style="color:#C792EA"> long</span><span style="color:#EEFFFF"> n</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#EEFFFF">    cin </span><span style="color:#89DDFF">&gt;&gt;</span><span style="color:#EEFFFF"> n</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    if</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">n </span><span style="color:#89DDFF">==</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span><span style="color:#F07178"> cout </span><span style="color:#89DDFF">&lt;&lt;</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF"> &lt;&lt;</span><span style="color:#89DDFF"> "</span><span style="color:#EEFFFF">\n</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF;font-style:italic"> return</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    if</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">n </span><span style="color:#89DDFF">==</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span><span style="color:#F07178"> cout </span><span style="color:#89DDFF">&lt;&lt;</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF"> &lt;&lt;</span><span style="color:#89DDFF"> "</span><span style="color:#EEFFFF">\n</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF;font-style:italic"> return</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">    Matrix </span><span style="color:#82AAFF">T</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> MOD</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#EEFFFF">    T</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> {{</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#89DDFF">           {</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">}};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">    Matrix P </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> mpow</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">T</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> n </span><span style="color:#89DDFF">-</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#545454;font-style:italic">    // State(n) = P * State(1), State(1) = [1, 0]^T</span></span>
<span class="line"><span style="color:#545454;font-style:italic">    // F(n) is the top component -&gt; top-left entry of P</span></span>
<span class="line"><span style="color:#EEFFFF">    cout </span><span style="color:#89DDFF">&lt;&lt;</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">P</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">][</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> %</span><span style="color:#EEFFFF"> MOD</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> &lt;&lt;</span><span style="color:#89DDFF"> "</span><span style="color:#EEFFFF">\n</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre></div><button class="copy-btn" title="Copy" aria-label="Copy code"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div>
<hr data-pos-start="251" data-pos-end="251">
<h2 data-pos-start="253" data-pos-end="253">4) <strong data-pos-start="253" data-pos-end="253">Another Example: Graph Paths (Exact Length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span>)</strong></h2>
<p data-pos-start="255" data-pos-end="255"><strong data-pos-start="255" data-pos-end="255">Task:</strong> number of length‚Äë<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> paths from node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> to node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> in a directed (possibly multi‚Äëedge) graph.</p>
<h3 data-pos-start="257" data-pos-end="257">Naive DP (works, but dies if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> is huge)</h3>
<p data-pos-start="259" data-pos-end="259">Let</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3em; vertical-align: -1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span style="top: -3.75em;"><span class="pstrut" style="height: 2.84em;"></span><span class="mord"></span></span><span style="top: -2.25em;"><span class="pstrut" style="height: 2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">#</span><span class="mopen">{</span><span class="mord text"><span class="mord">paths&nbsp;of&nbsp;length&nbsp;</span></span><span class="mord">‚Ñì</span><span class="mord text"><span class="mord">&nbsp;from&nbsp;</span></span><span class="mord">1</span><span class="mord text"><span class="mord">&nbsp;to&nbsp;</span></span><span class="mord mathnormal">u</span><span class="mclose">}</span><span class="mpunct">,</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel">ÓÄ†</span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">0.</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p data-pos-start="267" data-pos-end="267">Transition:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3em; vertical-align: -1.25em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span style="top: -1.9em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span><span style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span><span class="mop op-symbol large-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">#</span><span class="mord text"><span class="mord">edges</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<h3 data-pos-start="272" data-pos-end="272">Adjacency Matrix View</h3>
<p data-pos-start="274" data-pos-end="274">Build <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> with <strong data-pos-start="274" data-pos-end="274">row = from, col = to</strong>:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">#</span><span class="mord text"><span class="mord">edges</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="279" data-pos-end="279">Treat <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span></span></span></span> as a <strong data-pos-start="279" data-pos-end="279">row vector</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]]</span></span></span></span>. Then</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1491em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1461em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">‚ä§</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mclose">]</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="286" data-pos-end="286">Answer for paths <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> is</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1491em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;in&nbsp;1-indexed&nbsp;math</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚ü∫</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1491em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;in&nbsp;0-indexed&nbsp;code</span></span><span class="mord">.</span></span></span></span></span>
<h3 data-pos-start="293" data-pos-end="293"><strong data-pos-start="293" data-pos-end="293">Graph Paths Code</strong></h3>
<div class="code-container" style="position: relative; --accent: #89ddff;"><div class="shiki-block"><pre class="shiki material-theme-darker" style="background-color:#212121;color:#EEFFFF" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">#include</span><span style="color:#89DDFF"> &lt;</span><span style="color:#C3E88D">iostream</span><span style="color:#89DDFF">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">#include</span><span style="color:#89DDFF"> &lt;</span><span style="color:#C3E88D">vector</span><span style="color:#89DDFF">&gt;</span></span>
<span class="line"><span style="color:#F78C6C">using</span><span style="color:#C792EA"> namespace</span><span style="color:#FFCB6B"> std</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">using</span><span style="color:#FFCB6B"> ll</span><span style="color:#89DDFF"> =</span><span style="color:#C792EA"> long</span><span style="color:#C792EA"> long</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#EEFFFF"> ll MOD </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">'</span><span style="color:#F78C6C">000</span><span style="color:#89DDFF">'</span><span style="color:#F78C6C">000</span><span style="color:#89DDFF">'</span><span style="color:#F78C6C">007LL</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">struct</span><span style="color:#FFCB6B"> Matrix</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">    int</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">    ll mod</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">    vector</span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178">vector</span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178">ll</span><span style="color:#89DDFF">&gt;&gt;</span><span style="color:#F07178"> a</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#82AAFF">    Matrix</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">int</span><span style="color:#EEFFFF;font-style:italic"> n</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> ll</span><span style="color:#EEFFFF;font-style:italic"> mod</span><span style="color:#89DDFF">,</span><span style="color:#C792EA"> bool</span><span style="color:#EEFFFF;font-style:italic"> ident</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> false)</span><span style="color:#89DDFF"> :</span><span style="color:#82AAFF"> n</span><span style="color:#89DDFF">(</span><span style="color:#F07178">n</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF"> mod</span><span style="color:#89DDFF">(</span><span style="color:#F07178">mod</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF"> a</span><span style="color:#89DDFF">(</span><span style="color:#F07178">n</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> vector</span><span style="color:#89DDFF">&lt;</span><span style="color:#FFCB6B">ll</span><span style="color:#89DDFF">&gt;(</span><span style="color:#F07178">n</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">))</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#89DDFF"> (</span><span style="color:#F07178">ident</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF;font-style:italic"> for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#F07178"> i </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#F07178"> i </span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#F07178">i</span><span style="color:#89DDFF">)</span><span style="color:#EEFFFF"> a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">i</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#FFCB6B">    Matrix</span><span style="color:#F78C6C"> operator</span><span style="color:#FFCB6B">*</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">const</span><span style="color:#FFCB6B"> Matrix</span><span style="color:#C792EA">&amp;</span><span style="color:#EEFFFF;font-style:italic"> o</span><span style="color:#89DDFF">)</span><span style="color:#C792EA"> const</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">        Matrix </span><span style="color:#82AAFF">r</span><span style="color:#89DDFF">(</span><span style="color:#F07178">n</span><span style="color:#89DDFF">,</span><span style="color:#F07178"> mod</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#F07178"> i </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#F07178"> i </span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#F07178">i</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#F07178"> k </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#F07178"> k </span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#F07178">k</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF;font-style:italic"> if</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">k</span><span style="color:#89DDFF">])</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">                ll aik </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">k</span><span style="color:#89DDFF">];</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">                for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#F07178"> j </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#F07178"> j </span><span style="color:#89DDFF">&lt;</span><span style="color:#F07178"> n</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#F07178">j</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">                    r</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">j</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">r</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">i</span><span style="color:#89DDFF">][</span><span style="color:#F07178">j</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> +</span><span style="color:#F07178"> aik </span><span style="color:#89DDFF">*</span><span style="color:#EEFFFF"> o</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">k</span><span style="color:#89DDFF">][</span><span style="color:#F07178">j</span><span style="color:#89DDFF">])</span><span style="color:#89DDFF"> %</span><span style="color:#F07178"> mod</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">                }</span></span>
<span class="line"><span style="color:#89DDFF">            }</span></span>
<span class="line"><span style="color:#89DDFF">        }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#F07178"> r</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B">Matrix</span><span style="color:#82AAFF"> mpow</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Matrix</span><span style="color:#EEFFFF;font-style:italic"> base</span><span style="color:#89DDFF">,</span><span style="color:#C792EA"> long</span><span style="color:#C792EA"> long</span><span style="color:#EEFFFF;font-style:italic"> p</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">    Matrix </span><span style="color:#82AAFF">ans</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">base</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">n</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> base</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">mod</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> true);</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    while</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">p </span><span style="color:#89DDFF">&gt;</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#89DDFF"> (</span><span style="color:#F07178">p </span><span style="color:#89DDFF">&amp;</span><span style="color:#F78C6C"> 1LL</span><span style="color:#89DDFF">)</span><span style="color:#F07178"> ans </span><span style="color:#89DDFF">=</span><span style="color:#F07178"> ans </span><span style="color:#89DDFF">*</span><span style="color:#F07178"> base</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">        base </span><span style="color:#89DDFF">=</span><span style="color:#F07178"> base </span><span style="color:#89DDFF">*</span><span style="color:#F07178"> base</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">        p </span><span style="color:#89DDFF">&gt;&gt;=</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#EEFFFF"> ans</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">int</span><span style="color:#82AAFF"> main</span><span style="color:#89DDFF">()</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#FFCB6B">    ios</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">sync_with_stdio</span><span style="color:#89DDFF">(false);</span></span>
<span class="line"><span style="color:#EEFFFF">    cin</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">tie</span><span style="color:#89DDFF">(nullptr);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    int</span><span style="color:#EEFFFF"> n</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> m</span><span style="color:#89DDFF">;</span><span style="color:#C792EA"> long</span><span style="color:#C792EA"> long</span><span style="color:#EEFFFF"> k</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#EEFFFF">    cin </span><span style="color:#89DDFF">&gt;&gt;</span><span style="color:#EEFFFF"> n </span><span style="color:#89DDFF">&gt;&gt;</span><span style="color:#EEFFFF"> m </span><span style="color:#89DDFF">&gt;&gt;</span><span style="color:#EEFFFF"> k</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">    Matrix </span><span style="color:#82AAFF">A</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">n</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> MOD</span><span style="color:#89DDFF">);</span><span style="color:#545454;font-style:italic"> // A[from][to]</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    for</span><span style="color:#89DDFF"> (</span><span style="color:#C792EA">int</span><span style="color:#EEFFFF"> i </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span><span style="color:#EEFFFF"> i </span><span style="color:#89DDFF">&lt;</span><span style="color:#EEFFFF"> m</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> ++</span><span style="color:#EEFFFF">i</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">        int</span><span style="color:#F07178"> from</span><span style="color:#89DDFF">,</span><span style="color:#F07178"> to</span><span style="color:#89DDFF">;</span><span style="color:#545454;font-style:italic"> // edge from -&gt; to, 1-indexed input</span></span>
<span class="line"><span style="color:#F07178">        cin </span><span style="color:#89DDFF">&gt;&gt;</span><span style="color:#F07178"> from </span><span style="color:#89DDFF">&gt;&gt;</span><span style="color:#F07178"> to</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">        --</span><span style="color:#F07178">from</span><span style="color:#89DDFF">;</span><span style="color:#89DDFF"> --</span><span style="color:#F07178">to</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#EEFFFF">        A</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">from</span><span style="color:#89DDFF">][</span><span style="color:#F07178">to</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">A</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F07178">from</span><span style="color:#89DDFF">][</span><span style="color:#F07178">to</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> +</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> %</span><span style="color:#F07178"> MOD</span><span style="color:#89DDFF">;</span><span style="color:#545454;font-style:italic"> // row=from, col=to</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">    Matrix Ak </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> mpow</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">A</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> k</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">    // dp[0] = e1^T picks the first row when multiplying on the left:</span></span>
<span class="line"><span style="color:#545454;font-style:italic">    // dp[k][n] = (e1^T * A^k)[n] = (A^k)[0][n-1]</span></span>
<span class="line"><span style="color:#EEFFFF">    cout </span><span style="color:#89DDFF">&lt;&lt;</span><span style="color:#EEFFFF"> Ak</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">a</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">][</span><span style="color:#EEFFFF">n</span><span style="color:#89DDFF">-</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> &lt;&lt;</span><span style="color:#89DDFF"> "</span><span style="color:#EEFFFF">\n</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre></div><button class="copy-btn" title="Copy" aria-label="Copy code"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div>
<p data-pos-start="357" data-pos-end="357"><strong data-pos-start="357" data-pos-end="357">Why multi‚Äëedges become counts:</strong> each parallel edge is a distinct choice in a path, so it adds <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> into <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord text"><span class="mord">from</span></span><span class="mclose">]</span><span class="mopen">[</span><span class="mord text"><span class="mord">to</span></span><span class="mclose">]</span></span></span></span>.</p>
<hr data-pos-start="359" data-pos-end="359">
<h2 data-pos-start="361" data-pos-end="361">5) <strong data-pos-start="361" data-pos-end="361">How to Define the State &amp; Transition (Formal Derivation)</strong></h2>
<h3 data-pos-start="363" data-pos-end="363">5.1 General <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span>‚Äëterm linear recurrence</h3>
<p data-pos-start="365" data-pos-end="365">Given</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="minner">‚ãØ</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span>
<p data-pos-start="370" data-pos-end="370">define the <strong data-pos-start="370" data-pos-end="370">state</strong></p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 5.46em; vertical-align: -2.48em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span style="width: 0.667em; height: 5.4em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="5.400em" viewBox="0 0 667 5400"><path d="M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span style="width: 0.667em; height: 5.4em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="5.400em" viewBox="0 0 667 5400"><path d="M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1800 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="380" data-pos-end="380">Then</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 7.9863em; vertical-align: -4.4063em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -1.1737em;"><span class="pstrut" style="height: 5.58em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span style="top: -5.58em;"><span class="pstrut" style="height: 5.58em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span class="svg-align" style="top: -1.852em;"><span class="pstrut" style="height: 5.58em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height: 0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height: 0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span style="top: -5.58em;"><span class="pstrut" style="height: 5.58em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.55em;"><span style="top: -5.55em;"><span class="pstrut" style="height: 8.6em;"></span><span style="width: 0.667em; height: 6.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.600em" viewBox="0 0 667 6600"><path d="M403 1759 V84 H666 V0 H319 V1759 v3000 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v3000 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.05em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.4275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span><span style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -4.0275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -2.1675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -0.9675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.4275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span><span style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -4.0275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -2.1675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -0.9675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.24em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span><span style="top: -5.04em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span><span style="top: -3.84em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span><span style="top: -1.98em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ã±</span></span></span><span style="top: -0.78em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.4275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -4.0275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -2.1675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -0.9675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.58em;"><span style="top: -6.4275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span><span style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -4.0275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -2.1675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">‚ãÆ</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span style="top: -0.9675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.08em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.55em;"><span style="top: -5.55em;"><span class="pstrut" style="height: 8.6em;"></span><span style="width: 0.667em; height: 6.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.600em" viewBox="0 0 667 6600"><path d="M347 1759 V0 H0 V84 H263 V1759 v3000 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v3000 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.05em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.728em;"><span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 4.4063em;"><span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0713em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8213em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight" style="margin-right: 0.1952em;"></span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="394" data-pos-end="394">Pick <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span></span> so all entries of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> are known (e.g., <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> if you‚Äôre given <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span>).</p>
<hr data-pos-start="396" data-pos-end="396">
<h3 data-pos-start="398" data-pos-end="398">5.2 Fibonacci</h3>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.4em; vertical-align: -0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<hr data-pos-start="405" data-pos-end="405">
<h3 data-pos-start="407" data-pos-end="407">5.3 Tribonacci</h3>
<p data-pos-start="409" data-pos-end="409"><strong data-pos-start="409" data-pos-end="409">Recurrence &amp; Bases</strong></p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1.</span></span></span></span></span>
<p data-pos-start="415" data-pos-end="415"><strong data-pos-start="415" data-pos-end="415">State and Transition</strong></p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="430" data-pos-end="430">Take <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0991em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">‚ä§</span></span></span></span></span></span></span></span></span></span></span>, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight" style="margin-right: 0.1952em;"></span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span>.</p>
<p data-pos-start="432" data-pos-end="432"><strong data-pos-start="432" data-pos-end="432">Compute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">7</span><span class="mclose">)</span></span></span></span> (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord">7</span><span class="mclose">)</span></span></span></span>)</strong></p>
<p data-pos-start="434" data-pos-end="434">Squares:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">7</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">6</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">13</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">7</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">11</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">6</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">7</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="441" data-pos-end="441">Jump:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">7</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8641em;"></span><span class="mord text"><span class="mord">first&nbsp;column&nbsp;of&nbsp;</span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">13</span></span></span><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">7</span></span></span><span style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span style="width: 0.667em; height: 3.6em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚áí</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">Tri</span></span><span class="mopen">(</span><span class="mord">7</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">13.</span></span></span></span></span>
<hr data-pos-start="448" data-pos-end="448">
<h3 data-pos-start="450" data-pos-end="450">5.4 Graph Paths</h3>
<p data-pos-start="452" data-pos-end="452">Define</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">#</span><span class="mopen">{</span><span class="mord text"><span class="mord">paths&nbsp;of&nbsp;length&nbsp;</span></span><span class="mord">‚Ñì</span><span class="mord text"><span class="mord">&nbsp;from&nbsp;</span></span><span class="mord">1</span><span class="mord text"><span class="mord">&nbsp;to&nbsp;</span></span><span class="mord mathnormal">u</span><span class="mclose">}</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="457" data-pos-end="457">Let the <strong data-pos-start="457" data-pos-end="457">state at layer <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord">‚Ñì</span></span></span></span></strong> be the <strong data-pos-start="457" data-pos-end="457">row</strong> vector</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">‚Ñì</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.2em; vertical-align: -0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.85em;"><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.85em;"><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.85em;"><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="minner">‚ãØ</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.85em;"><span style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="465" data-pos-end="465">Build <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> with <strong data-pos-start="465" data-pos-end="465">row = from, col = to</strong>:</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">#</span><span class="mord text"><span class="mord">edges</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p data-pos-start="470" data-pos-end="470">Then</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">‚Ñì</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">‚Ñì</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1461em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">‚ä§</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span></span>
<p data-pos-start="474" data-pos-end="474">so</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1461em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">‚ä§</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">#</span><span class="mord text"><span class="mord">paths&nbsp;</span></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">n</span><span class="mord text"><span class="mord">&nbsp;of&nbsp;length&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1491em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;(1‚Äëindex)</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1491em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;(0‚Äëindex)</span></span><span class="mord">.</span></span></span></span></span>
<hr data-pos-start="480" data-pos-end="480">
<h2 data-pos-start="482" data-pos-end="482">6) <strong data-pos-start="482" data-pos-end="482">Closing Notes (Pattern + Caveats)</strong></h2>
<h3 data-pos-start="484" data-pos-end="484"><strong data-pos-start="484" data-pos-end="484">Pattern</strong></h3>
<ol data-pos-start="485" data-pos-end="489">
<li data-pos-start="485" data-pos-end="485"><strong data-pos-start="485" data-pos-end="485">Define state.</strong> Package just enough info into a vector so one step forward is linear.</li>
<li data-pos-start="486" data-pos-end="486"><strong data-pos-start="486" data-pos-end="486">Build transition <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span>.</strong> Write the recurrence as a dot product of coefficients with past state.</li>
<li data-pos-start="487" data-pos-end="487"><strong data-pos-start="487" data-pos-end="487">Choose base index.</strong> Decide if your base is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span> or <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</li>
<li data-pos-start="488" data-pos-end="488"><strong data-pos-start="488" data-pos-end="488">Compute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">power</span></span></span></span></span></span></span></span></span></span></span></span></span></strong> with <strong data-pos-start="488" data-pos-end="488">binary exponentiation</strong> ‚Äî <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</li>
<li data-pos-start="489" data-pos-end="489"><strong data-pos-start="489" data-pos-end="489">Multiply once by the base vector.</strong> That gives <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">State</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</li>
</ol>
<h3 data-pos-start="491" data-pos-end="491"><strong data-pos-start="491" data-pos-end="491">How to Spot it From a Statement</strong></h3>
<ul data-pos-start="492" data-pos-end="497">
<li data-pos-start="492" data-pos-end="492">The next answer is a <strong data-pos-start="492" data-pos-end="492">weighted sum</strong> of the last <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> answers (not min/max/product/square).</li>
<li data-pos-start="493" data-pos-end="493"><strong data-pos-start="493" data-pos-end="493">Coefficients are constant</strong> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> (fixed transition).</li>
<li data-pos-start="494" data-pos-end="496">Graph path DP that looks like
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0497em; vertical-align: -0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">‚àë</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.0017em;"><span style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">‚Ñì</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">edges</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>
is literally matrix multiplication with your <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span>.</li>
<li data-pos-start="497" data-pos-end="497">If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> or <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> goes up to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">18</span></span></span></span></span></span></span></span></span></span></span></span>, step‚Äëby‚Äëstep DP is impossible ‚Äî use matrix expo.</li>
</ul>
<h3 data-pos-start="499" data-pos-end="499"><strong data-pos-start="499" data-pos-end="499">Where It Shines</strong></h3>
<ul data-pos-start="500" data-pos-end="503">
<li data-pos-start="500" data-pos-end="500">Fibonacci/Tribonacci/<strong data-pos-start="500" data-pos-end="500">any</strong> fixed <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span>‚Äëterm linear recurrence.</li>
<li data-pos-start="501" data-pos-end="501">Population/Markov models.</li>
<li data-pos-start="502" data-pos-end="502">Graph path counts of exact length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span>.</li>
<li data-pos-start="503" data-pos-end="503">Automata DP (counting strings under constraints).</li>
</ul>
<h3 data-pos-start="505" data-pos-end="505"><strong data-pos-start="505" data-pos-end="505">Caveats</strong></h3>
<ul data-pos-start="506" data-pos-end="508">
<li data-pos-start="506" data-pos-end="506">Always mod after add/mul; use 64‚Äëbit intermediates before mod.</li>
<li data-pos-start="507" data-pos-end="507"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> can die when <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> is large (and squaring densifies matrices).</li>
<li data-pos-start="508" data-pos-end="508">Don‚Äôt overkill: if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> is small, plain DP may be faster/simpler.</li>
</ul>
<p data-pos-start="510" data-pos-end="510"><strong data-pos-start="510" data-pos-end="510">Aside.</strong> For 1‚ÄëD recurrences there‚Äôs also the <strong data-pos-start="510" data-pos-end="510">Kitamasa method</strong>, which targets <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> without building a full <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> matrix; out of scope here.</p>
<p data-pos-start="513" data-pos-end="514"><strong data-pos-start="513" data-pos-end="513">TLDR</strong><br data-pos-start="513" data-pos-end="514">
If the problem screams ‚Äúlinear recurrence + huge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>,‚Äù DP is naive.</p>
<p data-pos-start="516" data-pos-end="516">Answer = Define State <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">‚Üí</span></span></span></span> Build Transition <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">‚Üí</span></span></span></span> Fast Power. Enjoy mogging everyone else.</p>
<hr data-pos-start="518" data-pos-end="518">
<h2 data-pos-start="520" data-pos-end="520">Recommended Problems</h2>
<ul data-pos-start="521" data-pos-end="522">
<li data-pos-start="521" data-pos-end="521"><a href="https://usaco.guide/plat/matrix-expo" data-pos-start="521" data-pos-end="521">USACO Guide - Matrix Exponentiation</a></li>
<li data-pos-start="522" data-pos-end="522"><a href="https://vjudge.net/contest/628365" data-pos-start="522" data-pos-end="522">UCLA ICPC Spring Training #4 Contest</a></li>
</ul><style>
        .preview-wrapper {
          box-shadow: none;
          text-shadow: none;
          padding: 20px;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
          line-height: 1.6;
          color: var(--theme-text);
          background: var(--theme-bg);
          height: 100%;
          overflow-y: auto;
          overflow-x: auto;
        }

        /* Sleek scrollbars in preview */
        .preview-wrapper,
        .preview-wrapper pre,
        .preview-wrapper .shiki {
          scrollbar-width: thin; /* Firefox */
          scrollbar-color: var(--theme-accent) transparent;
        }
        .preview-wrapper::-webkit-scrollbar { height: 10px; width: 10px; }
        .preview-wrapper::-webkit-scrollbar-thumb {
          background-color: var(--theme-accent);
          border-radius: 8px;
          border: 2px solid transparent;
          background-clip: padding-box;
        }
        .preview-wrapper::-webkit-scrollbar-track { background: transparent; }

        .preview-wrapper pre::-webkit-scrollbar,
        .preview-wrapper .shiki::-webkit-scrollbar {
          height: 8px;
          width: 8px;
        }
        .preview-wrapper pre::-webkit-scrollbar-thumb,
        .preview-wrapper .shiki::-webkit-scrollbar-thumb {
          background-color: var(--accent);
          border-radius: 6px;
        }
        .preview-wrapper pre::-webkit-scrollbar-track,
        .preview-wrapper .shiki::-webkit-scrollbar-track {
          background: var(--accent);
        }
        
        .preview-wrapper h1, .preview-wrapper h2, .preview-wrapper h3, 
        .preview-wrapper h4, .preview-wrapper h5, .preview-wrapper h6 {
          margin-top: 1.5em;
          margin-bottom: 0.5em;
          font-weight: 600;
          line-height: 1.25;
          color: var(--theme-text);
        }
        
        .preview-wrapper h1 { font-size: 2em; border-bottom: 1px solid var(--theme-border); padding-bottom: 0.3em; }
        .preview-wrapper h2 { font-size: 1.5em; border-bottom: 1px solid var(--theme-border); padding-bottom: 0.3em; }
        .preview-wrapper h3 { font-size: 1.25em; }
        .preview-wrapper h4 { font-size: 1em; }
        .preview-wrapper h5 { font-size: 0.875em; }
        .preview-wrapper h6 { font-size: 0.85em; color: var(--theme-text); opacity: 0.8; }
        
        .preview-wrapper p {
          margin: 1em 0;
          color: var(--theme-text);
        }
        
        .preview-wrapper ul, .preview-wrapper ol {
          margin: 1em 0;
          padding-left: 2em;
        }
        
        .preview-wrapper li {
          margin: 0.25em 0;
          color: var(--theme-text);
        }
        
        .preview-wrapper blockquote {
          margin: 1em 0;
          padding: 0 1em;
          border-left: 4px solid var(--theme-accent);
          color: var(--theme-text);
          opacity: 0.8;
        }
        
        .preview-wrapper table {
          border-collapse: collapse;
          width: 100%;
          margin: 1em 0;
        }
        
        .preview-wrapper th, .preview-wrapper td {
          border: 1px solid var(--theme-border);
          padding: 0.5em;
          text-align: left;
        }
        
        .preview-wrapper th {
          background: var(--code-bg);
          font-weight: 600;
          color: var(--theme-text);
        }
        
        .preview-wrapper td {
          background: var(--theme-bg);
          color: var(--theme-text);
        }
        
        /* Inline code styling (avoid affecting Shiki blocks) */
        .preview-wrapper :not(pre) > code {
          background: var(--code-bg);
          color: var(--code-text);
          padding: 0.2em 0.4em;
          border-radius: 3px;
          font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
          font-size: 0.9em;
        }
        
        .preview-wrapper pre:not(.shiki) {
          background: var(--code-bg);
          color: var(--code-text);
          padding: 1em;
          border-radius: 6px;
          overflow-x: auto;
          margin: 1em 0;
          font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
          line-height: 1.4;
          border: 1px solid var(--theme-border);
        }
        
        .preview-wrapper pre:not(.shiki) code {
          background: none;
          padding: 0;
          border-radius: 0;
          color: inherit;
        }
        
        .preview-wrapper a {
          color: var(--theme-accent);
          text-decoration: none;
        }
        
        .preview-wrapper a:hover {
          text-decoration: underline;
        }
        
        .preview-wrapper hr {
          border: none;
          border-top: 1.5px solid var(--theme-accent);
          margin: 2em 0;
        }
        
        .preview-wrapper img {
          max-width: 100%;
          height: auto;
          border-radius: 4px;
          margin: 1em 0;
        }

        /* Ensure KaTeX lines do not break awkwardly */
        .katex { white-space: normal; }
        .katex-display { overflow-x: auto; }
        
        .mermaid-block {
          margin: 1em 0;
          text-align: center;
          min-height: 24px;
          overflow: visible;
        }
        .mermaid-block svg { max-width: 100%; height: auto; }
        .mermaid-block .foreignObject { overflow: visible; }

        /* Keep SVG responsive */
        .mermaid-block .flowchartTitleText { white-space: nowrap; }

        /* Fallback: force readable label text if a theme hides it */
        .mermaid-block .label text,
        .mermaid-block .label span,
        .mermaid-block .nodeLabel,
        .mermaid-block .edgeLabel text {
          fill: var(--theme-text) !important;
          color: var(--theme-text) !important;
        }
        
        /* Slightly compact default text to reduce overall width */
        .mermaid-block svg text {
          font-size: 12px;
        }
        
        /* Reduce extra paddings often added around diagrams */
        .mermaid-block svg { padding: 0; }
        
        }
        
        .math-block {
          margin: 1em 0;
          text-align: center;
        }
        
        .code-block {
          margin: 1em 0;
          border-radius: 6px;
          overflow: hidden;
          border: 1px solid var(--theme-border);
        }
        
        /* KaTeX overflow fixes: prevent per-equation scrollbars */
        .preview-wrapper .katex,
        .preview-wrapper .katex-display,
        .preview-wrapper .katex-display > .katex,
        .preview-wrapper .katex-display .katex-html {
          overflow: visible !important;
          max-width: 100%;
        }
        .preview-wrapper .katex-display > .katex {
          white-space: normal !important;
        }
        
        /* Print styles */
        @page {
          size: A4;
          margin: 0;
        }
        
        @media print {
          html, body, .preview-wrapper {
            margin: 0 !important;
            padding: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: var(--theme-bg) !important;
            color: var(--theme-text) !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
            color-adjust: exact !important;
          }
          
          .preview-wrapper, .preview-wrapper * {
            background-color: inherit !important;
            color: inherit !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          
          pre, code, .code-block {
            background: var(--code-bg) !important;
            color: var(--code-text) !important;
            box-shadow: none !important;
            border: none !important;
            opacity: 1 !important;
            isolation: isolate;
            page-break-inside: avoid;
          }
          
          mjx-container, mjx-container * {
            fill: currentColor !important;
            stroke: currentColor !important;
            color: var(--theme-text) !important;
            opacity: 1 !important;
            filter: none !important;
            text-shadow: none !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          
          mjx-container svg {
            shape-rendering: geometricPrecision !important;
            text-rendering: geometricPrecision !important;
            image-rendering: optimizeQuality !important;
          }
          
          .mermaid-block svg {
            vector-effect: non-scaling-stroke;
            max-width: 100%;
            height: auto;
          }
          
          mjx-container, .mermaid-block, pre, code {
            page-break-inside: avoid !important;
          }
        }
      </style></div>
<script>
  (function(){
    function getCodeFromButton(btn){
      var container = btn.closest ? btn.closest('.code-container') : null;
      if(!container) return '';
      var pre = container.querySelector('pre');
      if(pre && pre.textContent) return pre.textContent;
      var code = container.querySelector('code');
      return code && code.textContent ? code.textContent : '';
    }
    function fallbackCopy(text){
      var ta = document.createElement('textarea');
      ta.value = text;
      ta.setAttribute('readonly','');
      ta.style.position = 'fixed';
      ta.style.left = '-9999px';
      document.body.appendChild(ta);
      ta.select();
      try { document.execCommand('copy'); } catch(e) {}
      document.body.removeChild(ta);
    }
    function copyText(text){
      if(!text) return;
      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(text).catch(function(){ fallbackCopy(text); });
      } else {
        fallbackCopy(text);
      }
    }
    document.addEventListener('click', function(e){
      var target = e.target;
      if(!(target instanceof Element)) return;
      var btn = target.closest ? target.closest('.copy-btn') : null;
      if(btn){
        e.preventDefault();
        var text = getCodeFromButton(btn);
        copyText(text);
      }
    });

    // Click-to-activate horizontal scroll lock inside code blocks; disabled on mobile
    (function(){
      var isMobile = (function(){ try { return window.innerWidth < 768; } catch(_) { return false; } })();
      var scrollLock = new WeakMap();
      document.addEventListener('click', function(e){
        var el = e.target instanceof Element ? e.target.closest('.code-container') : null;
        if(!el) return;
        if(isMobile) return;
        var pre = el.querySelector('pre.shiki');
        if(!pre) return;
        var hasOverflow = pre.scrollWidth > pre.clientWidth;
        scrollLock.set(el, !!hasOverflow);
      });
      document.addEventListener('wheel', function(e){
        var el = e.target instanceof Element ? e.target.closest('.code-container') : null;
        if(!el) return;
        if(isMobile) return;
        if(!scrollLock.get(el)) return;
        var pre = el.querySelector('pre.shiki');
        if(!pre) return;
        e.preventDefault();
        var dx = Math.abs(e.deltaY) >= Math.abs(e.deltaX) ? e.deltaY : e.deltaX;
        pre.scrollTo({ left: pre.scrollLeft + dx, behavior: 'smooth' });
      }, { passive: false });
    })();
  })();
</script>
</body>
</html>